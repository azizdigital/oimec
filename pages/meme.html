<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üõ¢Ô∏è Daily Coordination Meeting Dashboard - Malaysian Edition</title>
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #1e293b 0%, #334155 50%, #475569 100%);
            color: #e2e8f0;
            min-height: 100vh;
            line-height: 1.5;
            overflow-x: hidden;
        }

        /* Welcome Prompt Styles */
        .welcome-prompt {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0369a1 100%);
            z-index: 5000;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.8s ease;
        }

        .welcome-prompt.fade-out {
            opacity: 0;
            visibility: hidden;
        }

        .welcome-content {
            background: rgba(15, 23, 42, 0.95);
            border: 3px solid rgba(251, 191, 36, 0.8);
            border-radius: 25px;
            padding: 60px 50px;
            text-align: center;
            max-width: 600px;
            width: 90%;
            backdrop-filter: blur(20px);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5), 0 0 50px rgba(251, 191, 36, 0.3);
            position: relative;
            overflow: hidden;
        }

        .welcome-content::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 30px,
                rgba(251, 191, 36, 0.1) 30px,
                rgba(251, 191, 36, 0.1) 60px
            );
            animation: welcome-shine 8s linear infinite;
        }

        @keyframes welcome-shine {
            0% { transform: translateX(-100%) translateY(-100%); }
            100% { transform: translateX(100%) translateY(100%); }
        }

        .welcome-icon {
            font-size: 5em;
            margin-bottom: 25px;
            position: relative;
            z-index: 2;
            animation: welcome-bounce 2s ease-in-out infinite;
        }

        @keyframes welcome-bounce {
            0%, 100% { transform: translateY(0px) scale(1); }
            50% { transform: translateY(-15px) scale(1.1); }
        }

        .welcome-title {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 20px;
            color: #fbbf24;
            text-shadow: 0 0 20px rgba(251, 191, 36, 0.8);
            position: relative;
            z-index: 2;
            animation: welcome-glow 3s ease-in-out infinite alternate;
        }

        @keyframes welcome-glow {
            from { text-shadow: 0 0 20px rgba(251, 191, 36, 0.8); }
            to { text-shadow: 0 0 40px rgba(251, 191, 36, 1), 0 0 60px rgba(14, 165, 233, 0.5); }
        }

        .welcome-subtitle {
            font-size: 1.2em;
            color: #e2e8f0;
            margin-bottom: 30px;
            position: relative;
            z-index: 2;
            line-height: 1.6;
        }

        .welcome-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 30px;
            position: relative;
            z-index: 2;
        }

        .welcome-btn {
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            color: white;
            padding: 15px 35px;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(14, 165, 233, 0.4);
            position: relative;
            overflow: hidden;
        }

        .welcome-btn:hover {
            background: linear-gradient(135deg, #0284c7, #0369a1);
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(14, 165, 233, 0.6);
        }

        .welcome-btn.secondary {
            background: linear-gradient(135deg, #64748b, #475569);
            box-shadow: 0 8px 25px rgba(100, 116, 139, 0.4);
        }

        .welcome-btn.secondary:hover {
            background: linear-gradient(135deg, #475569, #334155);
            box-shadow: 0 12px 35px rgba(100, 116, 139, 0.6);
        }

        .welcome-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }

        .welcome-btn:hover::before {
            left: 100%;
        }

        .welcome-status {
            margin-top: 20px;
            font-size: 0.9em;
            color: #94a3b8;
            position: relative;
            z-index: 2;
        }
        
        .container { 
            max-width: 1400px; 
            margin: 0 auto; 
            padding: 20px; 
        }
        
        .header {
            text-align: center;
            background: rgba(15, 23, 42, 0.8);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid rgba(148, 163, 184, 0.2);
            backdrop-filter: blur(10px);
            position: relative;
        }
        
        .header h1 {
            font-size: 2.2em;
            color: #f1f5f9;
            margin-bottom: 8px;
            font-weight: 600;
            animation: glow-text 3s ease-in-out infinite alternate;
        }
        
        @keyframes glow-text {
            from { text-shadow: 0 0 5px #0ea5e9; }
            to { text-shadow: 0 0 20px #0ea5e9, 0 0 30px #0ea5e9; }
        }
        
        .subtitle {
            color: #94a3b8;
            font-size: 0.95em;
            margin-bottom: 10px;
        }
        
        .time-display {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            font-size: 0.9em;
        }
        
        .time-zone {
            background: rgba(0, 0, 0, 0.3);
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid rgba(14, 165, 233, 0.3);
        }
        
        .control-buttons {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .control-btn {
            background: rgba(14, 165, 233, 0.2);
            border: 1px solid #0ea5e9;
            color: #0ea5e9;
            padding: 12px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2em;
            transition: all 0.3s ease;
            white-space: nowrap;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .control-btn.sound-btn {
            background: rgba(14, 165, 233, 0.2);
            border-color: #0ea5e9;
            color: #0ea5e9;
        }
        
        .control-btn.info-btn {
            background: rgba(16, 185, 129, 0.2);
            border-color: #10b981;
            color: #10b981;
        }
        
        .control-btn.readme-btn {
            background: rgba(245, 158, 11, 0.2);
            border-color: #f59e0b;
            color: #f59e0b;
        }
        
        .control-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        
        .control-btn.sound-btn:hover { background: rgba(14, 165, 233, 0.4); }
        .control-btn.info-btn:hover { background: rgba(16, 185, 129, 0.4); }
        .control-btn.readme-btn:hover { background: rgba(245, 158, 11, 0.4); }
        
        .upload-section {
            background: rgba(15, 23, 42, 0.6);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            text-align: center;
            border: 1px dashed #475569;
            backdrop-filter: blur(5px);
            position: relative;
        }
        
        .btn-upload {
            background: linear-gradient(135deg, #0ea5e9, #0284c7);
            color: white;
            padding: 10px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            margin-right: 10px;
        }
        
        .btn-upload:hover {
            background: linear-gradient(135deg, #0284c7, #0369a1);
            transform: translateY(-1px);
        }
        
        .btn-export {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 10px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .btn-export:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-1px);
        }
        
        /* Performance Grid Layout */
        .performance-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            grid-template-rows: auto auto auto auto auto;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .champion-today {
            grid-column: 1;
            grid-row: 1;
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: #92400e;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.3);
            border: 2px solid #f59e0b;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .champion-today:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(245, 158, 11, 0.4);
        }
        
        .champion-today::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 20px,
                rgba(255,255,255,0.1) 20px,
                rgba(255,255,255,0.1) 40px
            );
            animation: shine 4s linear infinite;
        }
        
        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%); }
            100% { transform: translateX(100%) translateY(100%); }
        }
        
        .champion-overall {
            grid-column: 2;
            grid-row: 1;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            color: #f1f5f9;
            border-radius: 12px;
            padding: 35px;
            text-align: center;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(251, 191, 36, 0.3);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .champion-overall:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.6);
        }
        
        .champion-overall::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(251, 191, 36, 0.1) 0%, transparent 50%, rgba(14, 165, 233, 0.1) 100%);
            opacity: 0.6;
        }
        
        .overall-crown {
            font-size: 3em;
            margin: 12px 0;
            position: relative;
            z-index: 2;
            filter: drop-shadow(0 0 10px rgba(251, 191, 36, 0.5));
            animation: gentle-float 4s ease-in-out infinite;
        }
        
        @keyframes gentle-float {
            0%, 100% { transform: translateY(0px) scale(1); }
            50% { transform: translateY(-3px) scale(1.02); }
        }
        
        .overall-title {
            font-size: 1em;
            font-weight: 600;
            margin-bottom: 15px;
            color: #fbbf24;
            position: relative;
            z-index: 2;
            text-shadow: 0 0 10px rgba(251, 191, 36, 0.3);
        }
        
        .overall-leader-name {
            font-size: 1.3em;
            font-weight: 700;
            margin-bottom: 12px;
            color: #e2e8f0;
            position: relative;
            z-index: 2;
        }
        
        .overall-stats {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #0ea5e9;
            position: relative;
            z-index: 2;
            text-shadow: 0 0 15px rgba(14, 165, 233, 0.4);
        }
        
        .overall-reason {
            font-size: 0.8em;
            color: #94a3b8;
            margin-bottom: 8px;
            position: relative;
            z-index: 2;
            font-style: italic;
        }
        
        .overall-quote {
            font-size: 0.75em;
            color: #cbd5e1;
            position: relative;
            z-index: 2;
            font-style: italic;
            opacity: 0.9;
        }
        
        .middle-row {
            grid-column: 1 / -1;
            grid-row: 2;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
        }
        
        .lower-row {
            grid-column: 1 / -1;
            grid-row: 3;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .bottom-row {
            grid-column: 1 / -1;
            grid-row: 4;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .ghost-row {
            grid-column: 1 / -1;
            grid-row: 5;
            display: flex;
            gap: 20px;
            justify-content: center;
        }
        
        /* NEW: OIM Intervention Box Styles */
        .intervention-box {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 50%, #7f1d1d 100%);
            color: #fef2f2;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(220, 38, 38, 0.4);
            border: 2px solid #ef4444;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 400px;
            max-width: 500px;
        }
        
        .intervention-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(220, 38, 38, 0.6);
        }
        
        .intervention-box::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 20px,
                rgba(255,255,255,0.05) 20px,
                rgba(255,255,255,0.05) 40px
            );
            animation: intervention-pulse 4s linear infinite;
        }
        
        @keyframes intervention-pulse {
            0% { transform: translateX(-100%) translateY(-100%); }
            100% { transform: translateX(100%) translateY(100%); }
        }
        
        .intervention-icons {
            font-size: 2.5em;
            margin-bottom: 15px;
            position: relative;
            z-index: 2;
            animation: slow-bounce 4s ease-in-out infinite;
        }
        
        @keyframes slow-bounce {
            0%, 100% { transform: translateY(0px); }
            25% { transform: translateY(-3px); }
            50% { transform: translateY(0px); }
            75% { transform: translateY(-2px); }
        }
        
        .intervention-title {
            font-size: 1.1em;
            font-weight: 700;
            margin-bottom: 20px;
            color: #fbbf24;
            position: relative;
            z-index: 2;
            text-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
        }
        
        .intervention-teams {
            text-align: left;
            margin: 15px 0;
            position: relative;
            z-index: 2;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            border-left: 3px solid #fbbf24;
        }
        
        .intervention-team {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9em;
        }
        
        .intervention-team:last-child {
            border-bottom: none;
        }
        
        .intervention-team-name {
            color: #e5e7eb;
            font-weight: 500;
        }
        
        .intervention-team-rank {
            color: #94a3b8;
            font-size: 0.8em;
            margin-right: 10px;
        }
        
        .intervention-team-percent {
            color: #ef4444;
            font-weight: bold;
        }
        
        .intervention-quote {
            font-size: 0.85em;
            font-style: italic;
            color: #fbbf24;
            margin-top: 15px;
            position: relative;
            z-index: 2;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
            line-height: 1.4;
        }
        
        .intervention-action {
            font-size: 0.8em;
            color: #fbbf24;
            margin-top: 10px;
            position: relative;
            z-index: 2;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .performance-card {
            background: rgba(15, 23, 42, 0.8);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid rgba(148, 163, 184, 0.2);
            backdrop-filter: blur(10px);
            position: relative;
            cursor: pointer;
        }
        
        .performance-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            border-color: rgba(148, 163, 184, 0.4);
        }
        
        .performance-card.rank-1 {
            border: 2px solid #fbbf24;
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.3);
        }
        
        .performance-card.rank-2 {
            border: 2px solid #c0c0c0;
            box-shadow: 0 0 15px rgba(192, 192, 192, 0.2);
        }
        
        .performance-card.rank-3 {
            border: 2px solid #cd7f32;
            box-shadow: 0 0 15px rgba(205, 127, 50, 0.2);
        }
        
        .performance-card.bottom-tier {
            border: 2px solid #ef4444;
            box-shadow: 0 0 15px rgba(239, 68, 68, 0.3);
            animation: warning-pulse 2s infinite;
        }
        
        @keyframes warning-pulse {
            0%, 100% { box-shadow: 0 0 15px rgba(239, 68, 68, 0.3); }
            50% { box-shadow: 0 0 25px rgba(239, 68, 68, 0.6); }
        }
        
        .rank-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8em;
            font-weight: bold;
            color: white;
        }
        
        .rank-1 .rank-badge { background: linear-gradient(135deg, #fbbf24, #f59e0b); }
        .rank-2 .rank-badge { background: linear-gradient(135deg, #e5e7eb, #9ca3af); }
        .rank-3 .rank-badge { background: linear-gradient(135deg, #cd7f32, #a0522d); }
        .rank-badge.default { background: linear-gradient(135deg, #64748b, #475569); }
        
        .performance-icon {
            font-size: 2.5em;
            margin-bottom: 12px;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3));
            position: relative;
        }
        
        .rank-1 .performance-icon {
            animation: crown-float 3s ease-in-out infinite;
        }
        
        @keyframes crown-float {
            0%, 100% { transform: translateY(0px) scale(1); }
            50% { transform: translateY(-5px) scale(1.05); }
        }
        
        .performance-title {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 8px;
            color: #f1f5f9;
        }
        
        .performance-stats {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 10px;
            color: #0ea5e9;
            position: relative;
        }
        
        .rank-1 .performance-stats {
            color: #fbbf24;
            text-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
        }
        
        .work-group-name {
            font-size: 0.9em;
            font-weight: 500;
            color: #cbd5e1;
            margin-bottom: 8px;
        }
        
        .task-summary {
            font-size: 0.8em;
            color: #94a3b8;
            margin-bottom: 10px;
        }
        
        .performance-trend {
            font-size: 0.8em;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }
        
        .trend-up { 
            color: #00ff88; 
            font-weight: 600;
            text-shadow: 0 0 10px rgba(0, 255, 136, 0.3);
            background: rgba(0, 255, 136, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
        }
        .trend-down { 
            color: #ff4757; 
            font-weight: 600;
            text-shadow: 0 0 10px rgba(255, 71, 87, 0.3);
            background: rgba(255, 71, 87, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
        }
        .trend-stable { 
            color: #ffa502; 
            font-weight: 600;
            text-shadow: 0 0 10px rgba(255, 165, 2, 0.3);
            background: rgba(255, 165, 2, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
        }
        
        .distance-from-first {
            font-size: 0.75em;
            color: #94a3b8;
            opacity: 0.8;
            margin-bottom: 8px;
        }
        
        .offshore-quote {
            font-size: 0.8em;
            color: #94a3b8;
            font-style: italic;
            padding: 8px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
            border-left: 2px solid #0ea5e9;
        }
        
        .food-mood {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 1.5em;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        
        .champion-icon {
            font-size: 4.5em;
            margin: 15px 0;
            position: relative;
            z-index: 2;
        }
        
        .champion-title {
            font-size: 1.8em;
            font-weight: 700;
            margin-bottom: 12px;
            position: relative;
            z-index: 2;
        }
        
        .champion-stats {
            font-size: 3.2em;
            font-weight: bold;
            margin-bottom: 15px;
            position: relative;
            z-index: 2;
        }
        
        .champion-quote {
            font-size: 0.9em;
            font-style: italic;
            opacity: 0.9;
            position: relative;
            z-index: 2;
        }
        
        .achievements-section {
            background: rgba(15, 23, 42, 0.8);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid rgba(148, 163, 184, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .achievements-title {
            text-align: center;
            font-size: 1.6em;
            margin-bottom: 20px;
            color: #f1f5f9;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 15px;
        }
        
        .achievement-box {
            background: rgba(0, 0, 0, 0.3);
            color: #e2e8f0;
            padding: 18px;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid rgba(148, 163, 184, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .achievement-box:hover {
            transform: translateY(-2px);
            background: rgba(0, 0, 0, 0.5);
            border-color: #0ea5e9;
        }
        
        .achievement-box.weekend {
            border-color: #f59e0b;
            background: rgba(245, 158, 11, 0.1);
        }
        
        .achievement-box.weekday {
            border-color: #0ea5e9;
            background: rgba(14, 165, 233, 0.1);
        }
        
        .achievement-date {
            font-size: 0.85em;
            font-weight: 500;
            margin-bottom: 8px;
            opacity: 0.9;
        }
        
        .achievement-count {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 5px;
            color: #0ea5e9;
        }
        
        .achievement-label {
            font-size: 0.75em;
            opacity: 0.8;
        }
        
        .food-motivator {
            font-size: 0.7em;
            color: #fbbf24;
            margin-top: 5px;
            font-style: italic;
        }
        
        .no-data {
            text-align: center;
            padding: 40px;
            color: #94a3b8;
            grid-column: 1 / -1;
        }
        
        .wisdom-corner {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(15, 23, 42, 0.9);
            padding: 15px;
            border-radius: 10px;
            max-width: 300px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.2);
            transition: all 0.3s ease;
            cursor: pointer;
            z-index: 1000;
        }
        
        .wisdom-corner:hover {
            transform: translateY(-2px);
            border-color: #0ea5e9;
        }
        
        .weather-widget {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(15, 23, 42, 0.9);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.2);
            text-align: center;
            min-width: 150px;
            z-index: 1000;
        }
        
        .weather-temp {
            font-size: 1.5em;
            font-weight: bold;
            color: #0ea5e9;
        }
        
        .weather-desc {
            font-size: 0.8em;
            color: #94a3b8;
            margin-top: 5px;
        }
        
        .toast {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(15, 23, 42, 0.95);
            color: #fbbf24;
            padding: 20px 30px;
            border-radius: 12px;
            border: 2px solid #fbbf24;
            box-shadow: 0 0 30px rgba(251, 191, 36, 0.3);
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s ease;
            text-align: center;
            max-width: 400px;
        }
        
        .toast.show {
            opacity: 1;
            visibility: visible;
        }
        
        .toast-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4em;
            z-index: 1000;
            animation: celebrate 2s ease-in-out;
            pointer-events: none;
        }
        
        @keyframes celebrate {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0); }
            50% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(1); }
        }
        
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(15px);
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .popup-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .popup-content {
            background: rgba(15, 23, 42, 0.95);
            border: 2px solid rgba(251, 191, 36, 0.5);
            border-radius: 25px;
            padding: 50px;
            text-align: center;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            backdrop-filter: blur(20px);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5), 0 0 30px rgba(251, 191, 36, 0.3);
            transform: scale(0.8);
            transition: transform 0.4s ease;
            position: relative;
        }
        
        .popup-overlay.active .popup-content {
            transform: scale(1);
        }
        
        .popup-content::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 30px,
                rgba(251, 191, 36, 0.1) 30px,
                rgba(251, 191, 36, 0.1) 60px
            );
            animation: popup-shine 6s linear infinite;
        }
        
        @keyframes popup-shine {
            0% { transform: translateX(-100%) translateY(-100%); }
            100% { transform: translateX(100%) translateY(100%); }
        }
        
        .popup-icon {
            font-size: 5em;
            margin-bottom: 20px;
            position: relative;
            z-index: 2;
            animation: bounce-icon 2s ease-in-out infinite;
        }
        
        @keyframes bounce-icon {
            0%, 100% { transform: translateY(0px) scale(1); }
            25% { transform: translateY(-10px) scale(1.1); }
            50% { transform: translateY(0px) scale(1); }
            75% { transform: translateY(-5px) scale(1.05); }
        }
        
        .popup-title {
            font-size: 2.2em;
            font-weight: 700;
            margin-bottom: 15px;
            color: #fbbf24;
            text-shadow: 0 0 15px rgba(251, 191, 36, 0.5);
            position: relative;
            z-index: 2;
        }
        
        .popup-group-name {
            font-size: 1.3em;
            color: #e2e8f0;
            margin-bottom: 20px;
            position: relative;
            z-index: 2;
        }
        
        .popup-stats {
            font-size: 3.5em;
            font-weight: bold;
            color: #0ea5e9;
            margin-bottom: 20px;
            text-shadow: 0 0 20px rgba(14, 165, 233, 0.5);
            position: relative;
            z-index: 2;
        }
        
        .popup-quote {
            font-size: 1.1em;
            font-style: italic;
            color: #94a3b8;
            line-height: 1.6;
            position: relative;
            z-index: 2;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            border-left: 3px solid #0ea5e9;
        }
        
        .popup-close {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            color: #94a3b8;
            font-size: 2em;
            cursor: pointer;
            z-index: 3;
            transition: all 0.3s ease;
        }
        
        .popup-close:hover {
            color: #ef4444;
            transform: scale(1.2);
        }
        
        #jsonInput { display: none; }
        
        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.8em;
            pointer-events: none;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
            max-width: 200px;
            text-align: center;
        }
        
        .achievement-badges {
            position: fixed;
            top: 80px;
            left: 20px;
            background: rgba(15, 23, 42, 0.9);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.2);
            max-width: 200px;
            z-index: 1000;
        }
        
        .achievement-badges h4 {
            color: #fbbf24;
            font-size: 0.9em;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .badge-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }
        
        .badge {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }
        
        .badge.unlocked {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            box-shadow: 0 0 15px rgba(251, 191, 36, 0.5);
            animation: badge-glow 2s infinite alternate;
        }
        
        .badge.locked {
            background: rgba(64, 64, 64, 0.5);
            filter: grayscale(100%);
            opacity: 0.5;
        }
        
        @keyframes badge-glow {
            from { box-shadow: 0 0 15px rgba(251, 191, 36, 0.5); }
            to { box-shadow: 0 0 25px rgba(251, 191, 36, 0.8); }
        }
        
        .performance-chart {
            width: 100%;
            height: 40px;
            margin: 8px 0;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }
        
        .chart-line {
            stroke: #0ea5e9;
            stroke-width: 2;
            fill: none;
            filter: drop-shadow(0 0 3px rgba(14, 165, 233, 0.5));
        }
        
        .chart-area {
            fill: url(#chartGradient);
            opacity: 0.3;
        }
        
        .predictions-panel {
            background: rgba(15, 23, 42, 0.8);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            border: 1px solid rgba(148, 163, 184, 0.2);
            backdrop-filter: blur(10px);
            grid-column: 1 / -1;
        }
        
        .predictions-title {
            text-align: center;
            font-size: 1.4em;
            margin-bottom: 15px;
            color: #f1f5f9;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .predictions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .prediction-card {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            border-left: 3px solid #0ea5e9;
            transition: all 0.3s ease;
        }
        
        .prediction-card:hover {
            transform: translateY(-2px);
            border-left-color: #fbbf24;
            background: rgba(0, 0, 0, 0.5);
        }
        
        .prediction-icon {
            font-size: 1.5em;
            margin-right: 8px;
        }
        
        .prediction-title {
            font-size: 0.9em;
            font-weight: 600;
            color: #0ea5e9;
            margin-bottom: 5px;
        }
        
        .prediction-text {
            font-size: 0.8em;
            color: #e2e8f0;
            line-height: 1.4;
        }
        
        .prediction-confidence {
            font-size: 0.7em;
            color: #fbbf24;
            margin-top: 5px;
            font-style: italic;
        }
        
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(14, 165, 233, 0.3);
            border-radius: 50%;
            animation: float-particle 10s infinite linear;
        }
        
        @keyframes float-particle {
            0% {
                transform: translateY(100vh) translateX(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) translateX(100px);
                opacity: 0;
            }
        }

        /* Battle Mode Styles */
        .battle-arena {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #991b1b 100%);
            z-index: 3000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .battle-arena.active {
            opacity: 1;
            visibility: visible;
        }

        .battle-title {
            font-size: 3em;
            color: #fbbf24;
            text-align: center;
            margin-bottom: 30px;
            text-shadow: 0 0 20px rgba(251, 191, 36, 0.8);
            animation: battle-glow 2s ease-in-out infinite alternate;
        }

        @keyframes battle-glow {
            from { text-shadow: 0 0 20px rgba(251, 191, 36, 0.8); }
            to { text-shadow: 0 0 40px rgba(251, 191, 36, 1), 0 0 60px rgba(239, 68, 68, 0.5); }
        }

        .battle-contestants {
            display: flex;
            gap: 50px;
            align-items: center;
            margin-bottom: 40px;
        }

        .battle-team {
            background: rgba(15, 23, 42, 0.9);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            min-width: 300px;
            border: 3px solid transparent;
            animation: team-pulse 2s ease-in-out infinite;
        }

        .battle-team.winner {
            border-color: #fbbf24;
            box-shadow: 0 0 30px rgba(251, 191, 36, 0.8);
            animation: winner-celebration 1s ease-in-out;
        }

        @keyframes team-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        @keyframes winner-celebration {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1.05); }
        }

        .battle-vs {
            font-size: 4em;
            color: #ef4444;
            font-weight: bold;
            text-shadow: 0 0 20px rgba(239, 68, 68, 0.8);
            animation: vs-glow 1s ease-in-out infinite alternate;
        }

        @keyframes vs-glow {
            from { color: #ef4444; text-shadow: 0 0 20px rgba(239, 68, 68, 0.8); }
            to { color: #fbbf24; text-shadow: 0 0 30px rgba(251, 191, 36, 1); }
        }

        .battle-team-icon {
            font-size: 4em;
            margin-bottom: 20px;
            animation: icon-battle 3s ease-in-out infinite;
        }

        @keyframes icon-battle {
            0%, 100% { transform: translateX(0) rotate(0deg); }
            25% { transform: translateX(-5px) rotate(-5deg); }
            75% { transform: translateX(5px) rotate(5deg); }
        }

        .battle-team-name {
            font-size: 1.5em;
            color: #e2e8f0;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .battle-team-stats {
            font-size: 3em;
            color: #0ea5e9;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .battle-xp {
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 10px;
            margin-top: 15px;
            border: 1px solid #475569;
        }

        .battle-xp-label {
            font-size: 0.9em;
            color: #94a3b8;
            margin-bottom: 5px;
        }

        .battle-xp-bar {
            width: 100%;
            height: 20px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .battle-xp-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #059669);
            border-radius: 10px;
            transition: width 2s ease;
            position: relative;
        }

        .battle-xp-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 0.8em;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }

        /* Awards Ceremony Styles */
        .awards-ceremony {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f172a 0%, #581c87 50%, #7c2d12 100%);
            z-index: 3500;
            opacity: 0;
            visibility: hidden;
            transition: all 0.8s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .awards-ceremony.active {
            opacity: 1;
            visibility: visible;
        }

        .ceremony-stage {
            text-align: center;
            position: relative;
            z-index: 2;
        }

        .ceremony-title {
            font-size: 4em;
            color: #fbbf24;
            margin-bottom: 30px;
            text-shadow: 0 0 30px rgba(251, 191, 36, 1);
            animation: ceremony-title-glow 3s ease-in-out infinite;
        }

        @keyframes ceremony-title-glow {
            0%, 100% { 
                text-shadow: 0 0 30px rgba(251, 191, 36, 1);
                transform: scale(1);
            }
            50% { 
                text-shadow: 0 0 50px rgba(251, 191, 36, 1), 0 0 80px rgba(251, 191, 36, 0.8);
                transform: scale(1.05);
            }
        }

        .ceremony-countdown {
            font-size: 8em;
            color: #ef4444;
            font-weight: bold;
            margin: 50px 0;
            text-shadow: 0 0 40px rgba(239, 68, 68, 1);
            animation: countdown-pulse 1s ease-in-out;
        }

        @keyframes countdown-pulse {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1); opacity: 0.8; }
        }

        .ceremony-podium {
            display: flex;
            align-items: end;
            gap: 20px;
            margin-top: 40px;
            justify-content: center;
        }

        .podium-position {
            background: linear-gradient(135deg, #0f172a, #1e293b);
            border-radius: 15px 15px 0 0;
            padding: 20px;
            text-align: center;
            position: relative;
            border: 3px solid;
            animation: podium-rise 1s ease-out;
            min-width: 350px;
            max-width: 400px;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            align-items: center;
            overflow: hidden;
        }

        @keyframes podium-rise {
            0% { transform: translateY(100px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }

        .podium-1st {
            border-color: #fbbf24;
            height: 275px;
            box-shadow: 0 0 40px rgba(251, 191, 36, 0.8);
            animation-delay: 0.5s;
        }

        .podium-2nd {
            border-color: #c0c0c0;
            height: 227px;
            box-shadow: 0 0 30px rgba(192, 192, 192, 0.6);
            animation-delay: 0.3s;
        }

        .podium-3rd {
            border-color: #cd7f32;
            height: 179px;
            box-shadow: 0 0 30px rgba(205, 127, 50, 0.6);
            animation-delay: 0.1s;
        }

        .podium-rank {
            font-size: 1.6em;
            font-weight: bold;
            margin-bottom: 8px;
            line-height: 1;
            z-index: 2;
            position: relative;
        }

        .podium-1st .podium-rank { color: #fbbf24; }
        .podium-2nd .podium-rank { color: #c0c0c0; }
        .podium-3rd .podium-rank { color: #cd7f32; }

        .podium-icon {
            font-size: 2.5em;
            margin-bottom: 8px;
            animation: podium-icon-float 2s ease-in-out infinite;
            line-height: 1;
            z-index: 2;
            position: relative;
        }

        @keyframes podium-icon-float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-6px); }
        }

.podium-team {
    font-size: 1.2em;       /* ‚úÖ BIGGER FONT */
    color: #ffffff;         /* ‚úÖ BRIGHTER COLOR */
    font-weight: bold;
    margin-bottom: 8px;     /* ‚úÖ MORE SPACING */
    line-height: 1.3;       /* ‚úÖ BETTER LINE HEIGHT */
    max-width: 100%;
    overflow: visible;      /* ‚úÖ SHOW ALL TEXT */
    text-overflow: clip;    /* ‚úÖ NO CUTTING */
    white-space: normal;    /* ‚úÖ ALLOW WRAP */
    text-align: center;     /* ‚úÖ CENTER TEXT */
    z-index: 2;
    position: relative;
    min-height: 40px;       /* ‚úÖ RESERVE SPACE */
    display: flex;          /* ‚úÖ FLEXBOX */
    align-items: center;    /* ‚úÖ CENTER VERTICALLY */
    justify-content: center; /* ‚úÖ CENTER HORIZONTALLY */
}

        .podium-score {
            font-size: 1.3em;
            font-weight: bold;
            color: #0ea5e9;
            line-height: 1;
            z-index: 2;
            position: relative;
        }

        /* Confetti Animation */
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            animation: confetti-fall 3s linear infinite;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        /* XP and Gamification Styles */
        .xp-notification {
            position: fixed;
            top: 20%;
            right: 20px;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.5);
            z-index: 4000;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.5s ease;
        }

        .xp-notification.show {
            opacity: 1;
            transform: translateX(0);
        }

        .xp-amount {
            font-size: 2em;
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
        }

        .special-title {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #7c3aed, #a855f7);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(124, 58, 237, 0.5);
            animation: title-glow 2s ease-in-out infinite alternate;
        }

        @keyframes title-glow {
            from { box-shadow: 0 5px 15px rgba(124, 58, 237, 0.5); }
            to { box-shadow: 0 5px 25px rgba(124, 58, 237, 0.8); }
        }

        /* Level Progress Styles */
        .team-level {
            position: relative;
            margin: 10px 0;
        }

        .level-badge {
            display: inline-block;
            background: linear-gradient(135deg, #7c3aed, #a855f7);
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.7em;
            font-weight: bold;
            margin-right: 8px;
        }

        .level-progress {
            display: inline-block;
            width: 100px;
            height: 8px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
            overflow: hidden;
            vertical-align: middle;
        }

        .level-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #7c3aed, #a855f7);
            border-radius: 4px;
            transition: width 1s ease;
        }

        .popup-content h3 {
            color: #fbbf24;
            margin: 20px 0 10px 0;
            font-size: 1.2em;
        }

        .popup-content p {
            margin: 8px 0;
            line-height: 1.6;
        }

        .popup-content ul {
            margin: 10px 0 10px 20px;
        }

        .popup-content li {
            margin: 5px 0;
            line-height: 1.5;
        }

        .popup-content .info-box {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 3px solid #0ea5e9;
        }

        .popup-content .warning-box {
            background: rgba(245, 158, 11, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 3px solid #f59e0b;
        }
		
		/* Responsive */
        @media (max-width: 768px) {
            .performance-grid {
                grid-template-columns: 1fr;
            }
            
            .middle-row, .lower-row, .bottom-row {
                grid-template-columns: 1fr;
            }
            
            .time-display {
                flex-direction: column;
                gap: 10px;
            }
            
            .weather-widget {
                position: relative;
                top: auto;
                right: auto;
                margin-bottom: 20px;
            }
            
            .achievement-badges {
                position: relative;
                left: auto;
                top: auto;
                margin-bottom: 20px;
                max-width: 100%;
            }
            
            .control-buttons {
                position: relative;
                top: auto;
                right: auto;
                justify-content: center;
                margin-top: 15px;
            }
            
            .popup-content {
                max-width: 95%;
                padding: 30px 20px;
            }

            .ceremony-podium {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }

            .podium-position {
                width: 100%;
                max-width: 300px;
                height: auto !important;
                padding: 20px;
            }

            .welcome-buttons {
                flex-direction: column;
                align-items: center;
            }

            .battle-contestants {
                flex-direction: column;
                gap: 30px;
            }

            .battle-team {
                min-width: 250px;
            }

            .intervention-box {
                min-width: 300px;
                max-width: 400px;
            }
        }
    </style>
</head>
<body>
    <!-- Welcome Prompt -->
    <div class="welcome-prompt" id="welcomePrompt">
        <div class="welcome-content">
            <div class="welcome-icon">üõ¢Ô∏è</div>
            <div class="welcome-title">Welcome to Daily Coordination Meeting</div>
            <div class="welcome-subtitle">
                Ready to start your performance tracking session?<br>
                Load the latest activity data to begin the awards ceremony!
            </div>
            <div class="welcome-buttons">
                <button class="welcome-btn" onclick="triggerFileUpload()">
                    üìÅ Load Latest Data
                </button>
                <button class="welcome-btn secondary" onclick="startWithDemo()">
                    üé≠ Demo Mode
                </button>
            </div>
            <div class="welcome-status" id="welcomeStatus">
                Click "Load Latest Data" to upload your JSON file and start the ceremony!
            </div>
        </div>
    </div>

    <!-- Floating Particles -->
    <div class="particles" id="particles"></div>
    
    <!-- Battle Arena -->
    <div class="battle-arena" id="battleArena">
        <div class="ceremony-stage">
            <div class="battle-title">‚öîÔ∏è TEAM BATTLE ROYALE ‚öîÔ∏è</div>
            <div class="battle-contestants" id="battleContestants">
                <!-- Battle teams will be populated here -->
            </div>
            <button onclick="closeBattleMode()" style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white; padding: 15px 30px; border: none; border-radius: 25px; font-size: 1.1em; font-weight: bold; cursor: pointer; margin-top: 30px;">Close Battle</button>
        </div>
    </div>

    <!-- Awards Ceremony -->
    <div class="awards-ceremony" id="awardsCeremony">
        <div class="ceremony-stage">
            <div class="ceremony-title">üèÜ AWARDS CEREMONY üèÜ</div>
            <div class="ceremony-countdown" id="ceremonyCountdown">3</div>
            <div class="ceremony-podium" id="ceremonyPodium" style="display: none;">
                <!-- Podium will be populated here -->
            </div>
        </div>
    </div>

    <!-- XP Notification -->
    <div class="xp-notification" id="xpNotification">
        <div class="xp-amount">+250 XP</div>
        <div style="text-align: center; font-weight: bold;">LEVEL UP!</div>
    </div>
    
    <!-- Achievement Badges Panel -->
    <div class="achievement-badges" id="achievementBadges">
        <h4>üèÜ Team Achievement Badges</h4>
        <div class="badge-grid" id="badgeGrid">
            <!-- Badges will be populated by JavaScript -->
        </div>
    </div>
    
    <!-- Weather Widget -->
    <div class="weather-widget" id="weatherWidget">
        <div class="weather-temp" id="weatherTemp">üå§Ô∏è Good Weather</div>
        <div class="weather-desc" id="weatherDesc">Platform conditions: Optimal for work</div>
    </div>
    
    <!-- Motivational Toast -->
    <div class="toast" id="motivationalToast">
        <div class="toast-icon">üöÄ</div>
        <div id="toastMessage">Semangat team warriors!</div>
    </div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="control-buttons">
                <div class="control-btn readme-btn" id="readmeButton" title="User Guide">üìñ</div>
                <div class="control-btn info-btn" id="infoButton" title="How It Works">üìä</div>
                <div class="control-btn sound-btn" id="soundToggle" title="Sound Toggle">üîä</div>
            </div>
            <h1>üõ¢Ô∏è Daily Coordination Meeting Dashboard</h1>
            <div class="subtitle">
                Platform Performance Monitor - Real-time work activity tracking with team rankings
            </div>
            <div class="time-display" id="timeDisplay">
                <div class="time-zone">
                    <span>üá≤üáæ Kuala Lumpur: </span>
                    <span id="klTime">--:--</span>
                </div>
                <div class="time-zone">
                    <span>üõ¢Ô∏è Platform: </span>
                    <span id="platformTime">--:--</span>
                </div>
            </div>
        </div>

        <!-- Upload Section -->
        <div class="upload-section">
            <h3>üìä Import Activity Data</h3>
            <input type="file" id="jsonInput" accept=".json">
            <button class="btn-upload" onclick="document.getElementById('jsonInput').click()">
                üìÅ Load Activity Report
            </button>
            <button class="btn-export" onclick="exportReport()">
                üìã Export Performance Report
            </button>
            <div id="uploadStatus" style="margin-top: 10px; font-weight: 500;"></div>
        </div>

        <!-- Smart Predictions Panel -->
        <div class="predictions-panel">
            <div class="predictions-title">
                üîÆ Intelligent Work Predictions
            </div>
            <div class="predictions-grid" id="predictionsGrid">
                <!-- Predictions will be populated by JavaScript -->
            </div>
        </div>

        <!-- Performance Grid -->
        <div class="performance-grid" id="performanceGrid">
            <!-- Today's Champion -->
            <div class="champion-today" id="championToday" style="display: none;">
                <div class="food-mood" id="championFoodMood">üçõ</div>
                <div class="champion-title">üèÜ TODAY'S CHAMPION</div>
                <div class="champion-icon" id="championIcon">üëë</div>
                <div class="work-group-name" id="championName">Outstanding Team</div>
                <div class="champion-stats" id="championStats">100%</div>
                <div class="champion-quote" id="championQuote">"Legendary performance!"</div>
            </div>

            <!-- Overall Champion -->
            <div class="champion-overall" id="championOverall" style="display: none;">
                <div class="overall-crown">ü´Ö</div>
                <div class="overall-title">üèéÔ∏è PERFORMANCE LEADER</div>
                <div class="overall-leader-name" id="overallLeaderName">Supreme Team</div>
                <div class="overall-stats" id="overallStats">100%</div>
                <div class="overall-reason" id="overallReason">Consistent excellence across operations</div>
                <div class="overall-quote" id="overallQuote">"Steady like sunrise, fast like lightning!"</div>
            </div>

            <!-- Performance Cards Grid -->
            <div class="middle-row" id="middleRow"></div>
            <div class="lower-row" id="lowerRow"></div>
            <div class="bottom-row" id="bottomRow"></div>
            <div class="ghost-row" id="ghostRow"></div>
        </div>

        <!-- Activities Summary Section -->
        <div class="achievements-section">
            <div class="achievements-title">
                üìã Daily Activities Summary & Progress Tracker
            </div>
            <div class="achievements-grid" id="achievementsGrid">
                <!-- Activity boxes will be populated by JavaScript -->
            </div>
        </div>

        <!-- Wisdom Corner -->
        <div class="wisdom-corner" id="wisdomCorner">
            <strong style="color: #0ea5e9;">‚öì Platform Wisdom:</strong><br>
            <span id="wisdomText" style="color: #94a3b8;">"Click for daily motivation!"</span>
        </div>

        <!-- Tooltip -->
        <div class="tooltip" id="tooltip"></div>
        
        <!-- Popup -->
        <div class="popup-overlay" id="popupOverlay">
            <div class="popup-content">
                <button class="popup-close" onclick="closePopup()">&times;</button>
                <div class="popup-icon" id="popupIcon">üëë</div>
                <div class="popup-title" id="popupTitle">PERFORMANCE CHAMPION</div>
                <div class="popup-group-name" id="popupGroupName">Outstanding Team</div>
                <div class="popup-stats" id="popupStats">100%</div>
                <div class="popup-quote" id="popupQuote">"Excellence beyond expectations!"</div>
            </div>
        </div>

        <!-- User Guide Modal -->
        <div class="popup-overlay" id="readmeOverlay">
            <div class="popup-content">
                <button class="popup-close" onclick="closeReadmeModal()">&times;</button>
                <div class="popup-icon">üìñ</div>
                <div class="popup-title">USER GUIDE</div>
                <div style="text-align: left; padding: 20px; color: #e2e8f0; line-height: 1.6;">
                    
                    <h3>üìä How Ranking Works</h3>
                    <div class="warning-box">
                        <p><strong>Simple Formula:</strong> Average progress percentage per team</p>
                        <p><strong>Example:</strong> Team with activities at 10%, 50%, 80% = (10+50+80)√∑3 = 47% average</p>
                        <p><strong>Fair System:</strong> Teams with different workloads compete fairly</p>
                        <p><strong>Real-time Updates:</strong> Rankings refresh when new data is uploaded</p>
                    </div>
                    
                    <h3>üèÜ Performance Tiers</h3>
                    <div class="info-box">
                        <p><strong>üëë LEGEND:</strong> Top performer (Rank 1) - Outstanding results champion!</p>
                        <p><strong>ü¶Ö EAGLE:</strong> Silver medalist (Rank 2) - Sharp precision and excellence.</p>
                        <p><strong>ü¶à SHARK:</strong> Bronze champion (Rank 3) - Strong execution and delivery.</p>
                        <p><strong>üòé COOL:</strong> Steady performer (Rank 4) - Consistent and dependable.</p>
                        <p><strong>üê¢ TURTLE:</strong> Reliable worker (Rank 5) - Slow but steady progress.</p>
                        <p><strong>üêå SNAIL:</strong> Patient progress (Rank 6) - Gradual advancement.</p>
                    </div>
                    
                    <h3>üçõ Energy Indicators</h3>
                    <div class="info-box">
                        <p><strong>üçõ Nasi Lemak Power:</strong> 90-100% completion - Maximum energy!</p>
                        <p><strong>üçú Mee Goreng Momentum:</strong> 80-89% - Strong momentum!</p>
                        <p><strong>ü•ò Rendang Resilience:</strong> 70-79% - Solid and reliable.</p>
                        <p><strong>üç≤ Curry Confidence:</strong> 60-69% - Steady confidence.</p>
                        <p><strong>‚òï Kopi Break:</strong> Below 40% - Need energy boost!</p>
                    </div>
                    
                    <h3>üéÆ Gamification Features</h3>
                    <div class="info-box">
                        <p><strong>ü•ä Team Battles:</strong> Epic showdowns between top performers</p>
                        <p><strong>‚ö° XP System:</strong> Teams earn experience from progress and rankings</p>
                        <p><strong>üèÖ Special Titles:</strong> Unlock unique ranks like "Platform Warrior"</p>
                        <p><strong>üé™ Awards Ceremony:</strong> Dramatic reveal after data upload</p>
                        <p><strong>üìà Level System:</strong> Teams level up every 1000 XP earned</p>
                    </div>
                    
                    <h3>üèÜ Achievement Badges</h3>
                    <div class="info-box">
                        <p><strong>üé© Hat Trick Hero:</strong> 90%+ for 3 consecutive days</p>
                        <p><strong>üëë Comeback King:</strong> Last to first rank in 24 hours</p>
                        <p><strong>üîß Maintenance Master:</strong> Maintenance team 90%+ completion</p>
                        <p><strong>‚öôÔ∏è Operations Expert:</strong> Operations team excellence level</p>
                        <p><strong>üîç QC Perfectionist:</strong> Quality control team 100%</p>
                        <p><strong>‚ö° Speed Champion:</strong> Complete activities in record time</p>
                        <p><strong>üçõ Consistency Award:</strong> 70%+ for 7 straight days</p>
                        <p><strong>‚öîÔ∏è Weekend Warrior:</strong> Best weekend performance</p>
                        <p><strong>üöÄ Progress Rocket:</strong> 40%+ improvement in one week</p>
                    </div>
                    
                    <h3>üîÆ Smart Predictions</h3>
                    <div class="info-box">
                        <p><strong>Championship Analysis:</strong> Who's likely to win today</p>
                        <p><strong>Platform Conditions:</strong> Environmental impact on performance</p>
                        <p><strong>Performance Trends:</strong> Team momentum and trajectory</p>
                        <p><strong>Target Probability:</strong> Chances of hitting daily goals</p>
                    </div>
                    
                    <h3>üí° Success Tips</h3>
                    <ul style="margin-left: 20px;">
                        <li>‚úÖ Start activities early to climb rankings faster</li>
                        <li>‚úÖ Even 1% progress beats 0% - every step counts!</li>
                        <li>‚úÖ Click team cards for motivational quotes</li>
                        <li>‚úÖ Watch for achievement badge notifications</li>
                        <li>‚úÖ Check daily predictions for motivation</li>
                        <li>‚úÖ Use energy indicators to monitor team morale</li>
                        <li>‚úÖ Participate in team battles for extra excitement</li>
                        <li>‚úÖ Aim for special titles and XP rewards</li>
                    </ul>
                    
                    <div class="warning-box">
                        <h3 style="color: #fbbf24; margin-bottom: 10px;">üéØ Daily Coordination Meeting Usage</h3>
                        <p>This dashboard transforms your coordination meetings into engaging, gamified experiences. Upload activity data to trigger awards ceremonies, team battles, and real-time performance tracking with Malaysian humor and motivational elements.</p>
                        <p style="margin-top: 10px;"><strong>Remember:</strong> Great teams achieve targets while having fun! üöÄ</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- How It Works Modal -->
        <div class="popup-overlay" id="infoOverlay">
            <div class="popup-content">
                <button class="popup-close" onclick="closeInfoModal()">&times;</button>
                <div class="popup-icon">üìä</div>
                <div class="popup-title">HOW IT WORKS</div>
                <div style="text-align: left; padding: 20px; color: #e2e8f0; line-height: 1.6;">
                    
                    <h3>üßÆ Calculation Method</h3>
                    <div class="info-box">
                        <p><strong>Step 1:</strong> Individual Activity Progress<br>
                        Each work activity has a progress percentage (0-100%)</p>
                        
                        <p><strong>Step 2:</strong> Work Group Average<br>
                        Add all progress values √∑ number of activities per group</p>
                        
                        <p><strong>Step 3:</strong> Ranking<br>
                        Teams sorted by highest average progress percentage</p>
                    </div>
                    
                    <h3>üìù Calculation Example</h3>
                    <div class="warning-box">
                        <p><strong>Operations Team:</strong> 10% + 0% + 5% = 15% √∑ 3 = <strong>5% average</strong></p>
                        <p><strong>QC Team:</strong> 35% + 30% + 30% = 95% √∑ 3 = <strong>32% average</strong></p>
                        <p><strong>Result:</strong> QC Team ranks higher! üèÜ</p>
                    </div>
                    
                    <h3>üéØ Why This Method?</h3>
                    <ul style="margin-left: 20px;">
                        <li>‚úÖ Fair comparison for teams with different workloads</li>
                        <li>‚úÖ Rewards actual progress, not just completion</li>
                        <li>‚úÖ Shows which teams consistently make progress</li>
                        <li>‚úÖ Encourages teams to start work early!</li>
                        <li>‚úÖ Simple to understand and track</li>
                    </ul>
                    
                    <h3>üîÑ Data Processing</h3>
                    <div class="info-box">
                        <p><strong>Input:</strong> JSON file with work activities data</p>
                        <p><strong>Processing:</strong> Real-time calculation of team averages</p>
                        <p><strong>Output:</strong> Live ranking display with performance metrics</p>
                        <p><strong>Updates:</strong> Instant refresh when new data is uploaded</p>
                    </div>
                    
                    <div class="warning-box">
                        <strong style="color: #fbbf24;">üí° Pro Tip:</strong> Even 1% progress is better than 0%! Start your activities early to climb the rankings and motivate your team! üöÄ
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        console.log("üöÄ Daily Coordination Meeting Dashboard loading...");
        
        let globalData = null;
        let currentQuoteDay = 0;
        let soundEnabled = true;
        let achievementData = {}; 
        let performanceHistory = {};
        let teamXP = {}; // XP tracking for gamification
        let teamLevels = {}; // Level tracking
        let specialTitles = {}; // Special titles earned 
        
        // Achievement System
        const availableAchievements = [
            {
                id: 'hat_trick',
                icon: 'üé©',
                name: 'Hat Trick Hero',
                description: 'Three consecutive days at 90%+ completion',
                condition: (history) => checkConsecutiveDays(history, 90, 3)
            },
            {
                id: 'comeback_king',
                icon: 'üëë',
                name: 'Comeback King',
                description: 'From worst to first in rankings',
                condition: (history) => checkComebackStory(history)
            },
            {
                id: 'consistency_champion',
                icon: 'üçõ',
                name: 'Consistency Champion',
                description: 'Steady performance (7 days 70%+)',
                condition: (history) => checkConsistency(history, 70, 7)
            },
            {
                id: 'speed_demon',
                icon: '‚ö°',
                name: 'Speed Demon',
                description: 'Complete 100% in record time',
                condition: (history) => checkQuickCompletion(history)
            },
            {
                id: 'maintenance_master',
                icon: 'üîß',
                name: 'Maintenance Master',
                description: 'Maintenance team excellence',
                condition: (history) => checkMaintenanceExcellence(history)
            },
            {
                id: 'ops_expert',
                icon: '‚öôÔ∏è',
                name: 'Operations Expert',
                description: 'Operations team dominance',
                condition: (history) => checkOperationsExcellence(history)
            },
            {
                id: 'qc_perfectionist',
                icon: 'üîç',
                name: 'QC Perfectionist',
                description: 'Quality control perfection',
                condition: (history) => checkQCPerfection(history)
            },
            {
                id: 'weekend_warrior',
                icon: '‚öîÔ∏è',
                name: 'Weekend Warrior',
                description: 'Best weekend performance',
                condition: (history) => checkWeekendPerformance(history)
            },
            {
                id: 'rocket_booster',
                icon: 'üöÄ',
                name: 'Progress Rocket',
                description: 'Improve by 40%+ in one week',
                condition: (history) => checkRocketProgress(history)
            }
        ];
        
        // Smart Predictions
        const predictionTemplates = [
            {
                icon: 'üèÜ',
                title: 'Championship Prediction',
                generator: (groups) => generateChampionPrediction(groups)
            },
            {
                icon: 'üå§Ô∏è',
                title: 'Platform Conditions Forecast',
                generator: (groups) => generatePlatformPrediction(groups)
            },
            {
                icon: 'üìà',
                title: 'Performance Trajectory',
                generator: (groups) => generateTrendPrediction(groups)
            },
            {
                icon: 'üéØ',
                title: 'Target Achievement Probability',
                generator: (groups) => generateTargetPrediction(groups)
            }
        ];
        
        // Food mood indicators
        const foodMoods = {
            100: { emoji: "üçõ", desc: "Nasi lemak power level!" },
            90: { emoji: "üçú", desc: "Mee goreng momentum!" },
            80: { emoji: "ü•ò", desc: "Rendang resilience!" },
            70: { emoji: "üç≤", desc: "Curry confidence!" },
            60: { emoji: "ü•ú", desc: "Satay steady!" },
            50: { emoji: "üçû", desc: "Roti canai reliable!" },
            40: { emoji: "ü•§", desc: "Teh tarik tired!" },
            30: { emoji: "‚òï", desc: "Kopi break needed!" },
            20: { emoji: "üç™", desc: "Snack time!" },
            10: { emoji: "üíß", desc: "Hydration mode!" },
            0: { emoji: "üò¥", desc: "Rest time!" }
        };
        
        // Motivational messages
        const motivationalToasts = [
            { icon: "üöÄ", text: "Semangat team warriors! Let's achieve targets!" },
            { icon: "‚ö°", text: "Power levels increasing! Keep up the momentum!" },
            { icon: "üèÜ", text: "Champion mindset activated! Excellence mode ON!" },
            { icon: "üí™", text: "Strong teamwork makes the dream work!" },
            { icon: "üåü", text: "Performance shining bright today!" },
            { icon: "üî•", text: "Hot productivity levels detected!" },
            { icon: "‚≠ê", text: "Star quality performance!" },
            { icon: "üéØ", text: "Target locked! Precision work activated!" }
        ];
        
        // Performance tiers with Malaysian humor
        const performanceTiers = [
            {
                icon: "üëë",
                title: "PERFORMANCE LEGEND",
                rank: 1,
                quotes: [
                    "Excellence so legendary, even spreadsheets are impressed! Organization level: Supreme! üìäüëë",
                    "Completion rate making calculators jealous! Mathematics can't keep up with this performance! üßÆüî•",
                    "Efficiency breaking records faster than F1 at Sepang! Speed demon of productivity! üèéÔ∏èüí®"
                ]
            },
            {
                icon: "ü¶Ö",
                title: "EAGLE PERFORMER",
                rank: 2,
                quotes: [
                    "Eagle-eye precision on activities! Spotting tasks from high altitude! üõ∞Ô∏èüëÅÔ∏è",
                    "Soaring through work like eagle through clear skies! Flight path: excellence! ü¶Ö‚òÅÔ∏è",
                    "Task hunting with laser precision! Never misses a deadline! üéØ‚ö°"
                ]
            },
            {
                icon: "ü¶à",
                title: "SHARK ACHIEVER",
                rank: 3,
                quotes: [
                    "Shark instincts for activities! Swimming through tasks like apex predator! ü¶àüåä",
                    "Bronze medal hustle with platinum attitude! Podium regular! ü•âüëë",
                    "Cutting through work like hot knife through butter! Sharp operator! üî™üßà"
                ]
            },
            {
                icon: "üòé",
                title: "COOL OPERATOR",
                rank: 4,
                quotes: [
                    "Calm and collected approach, but results hotter than satay! Cool exterior, fire results! üî•üç¢",
                    "Cool as air-conditioning, reliable as morning coffee! Daily excellence! ü•íüìã",
                    "Zen master of tasks: Stay calm, complete work, repeat! üßò‚Äç‚ôÇÔ∏èüîÑ"
                ]
            },
            {
                icon: "üê¢",
                title: "STEADY TURTLE",
                rank: 5,
                quotes: [
                    "Slow and steady wins the race! Wisdom beats speed! üöóüèÅ",
                    "Turtle pace with reliable results! Old school power! üîß‚ö°",
                    "Steady progress like Earth's rotation! Natural law of consistency! üåç‚öñÔ∏è"
                ]
            },
            {
                icon: "üêå",
                title: "PATIENT SNAIL",
                rank: 6,
                quotes: [
                    "Slow but steady like queue at popular food stall! Worth the wait! üçõ‚è∞",
                    "Carrying tasks AND quality together! Ultimate multitasker! üè†üíº",
                    "Like brewing perfect tea, excellence takes time! Master class! ‚òïüë®‚Äçüç≥"
                ]
            }
        ];

        // Platform wisdom
        const platformWisdom = [
            "Quality work first, quantity second, but achieve both like expert chef! ‚öìüî®",
            "Good planning prevents poor performance! Plan like you're cooking rendang! üåäüëë",
            "One team, one dream, one excellence machine powered by determination! üõ¢Ô∏è‚ö°",
            "Every activity counts like every grain of rice! Complete with purpose! ‚ö°üìã",
            "Excellence: not our goal, it's our minimum standard! üèÜüìà",
            "When work gets tough, team gets tougher like Malaysian spirit! üí™üëë"
        ];

        // Special titles list
        const specialTitlesList = [
            { id: 'platform_warrior', name: 'Platform Warrior', xpBonus: 1000 },
            { id: 'perfectionist', name: 'Perfectionist', xpBonus: 1500 },
            { id: 'comeback_legend', name: 'Comeback Legend', xpBonus: 2000 }
        ];

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            console.log("‚úÖ Daily Coordination Meeting dashboard initializing...");
            
            try {
                currentQuoteDay = Math.floor(Date.now() / (1000 * 60 * 60 * 24)) % 4;
                
                initializeFeatures();
                initializeAchievementSystem();
                initializePerformanceHistory();
                setupWisdomCorner();
                setupFileUpload();
                setupPopupEvents();
                startTimeUpdates();
                createFloatingParticles();
                updateSmartPredictions();
                
                // Show welcome prompt first
                showWelcomePrompt();
                
                console.log("üéØ Dashboard ready for Daily Coordination Meeting!");
            } catch (error) {
                console.error("‚ùå Error initializing dashboard:", error);
            }
        });

        // Welcome Prompt System
        function showWelcomePrompt() {
            console.log("üëã Showing welcome prompt...");
            const welcomePrompt = document.getElementById('welcomePrompt');
            if (welcomePrompt) {
                welcomePrompt.style.display = 'flex';
                playSound('welcome');
                
                // Add some sparkle effects
                setTimeout(() => {
                    createWelcomeSparkles();
                }, 500);
            }
        }

        function triggerFileUpload() {
            console.log("üìÅ Triggering file upload from welcome prompt...");
            updateWelcomeStatus("Select your JSON file to begin...", "info");
            document.getElementById('jsonInput').click();
        }

        function startWithDemo() {
            console.log("üé≠ Starting with demo mode...");
            updateWelcomeStatus("Loading demo data...", "info");
            
            setTimeout(() => {
                hideWelcomePrompt();
                showDefaultState();
                showMotivationalToast("üé≠", "Demo mode activated! Explore the features!");
            }, 1500);
        }

        function hideWelcomePrompt() {
            const welcomePrompt = document.getElementById('welcomePrompt');
            if (welcomePrompt) {
                welcomePrompt.classList.add('fade-out');
                setTimeout(() => {
                    welcomePrompt.style.display = 'none';
                }, 800);
            }
        }

        function updateWelcomeStatus(message, type) {
            const statusElement = document.getElementById('welcomeStatus');
            if (statusElement) {
                statusElement.textContent = message;
                statusElement.style.color = type === 'success' ? '#10b981' : 
                                          type === 'error' ? '#ef4444' : '#94a3b8';
            }
        }

        function createWelcomeSparkles() {
            const welcomeContent = document.querySelector('.welcome-content');
            const colors = ['#fbbf24', '#0ea5e9', '#10b981', '#8b5cf6'];
            
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const sparkle = document.createElement('div');
                    sparkle.style.position = 'absolute';
                    sparkle.style.width = '4px';
                    sparkle.style.height = '4px';
                    sparkle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    sparkle.style.borderRadius = '50%';
                    sparkle.style.left = Math.random() * 100 + '%';
                    sparkle.style.top = Math.random() * 100 + '%';
                    sparkle.style.animation = 'sparkle 2s ease-out forwards';
                    sparkle.style.pointerEvents = 'none';
                    sparkle.style.zIndex = '3';
                    
                    // Add sparkle animation
                    const style = document.createElement('style');
                    style.textContent = `
                        @keyframes sparkle {
                            0% { transform: scale(0) rotate(0deg); opacity: 1; }
                            50% { transform: scale(1) rotate(180deg); opacity: 1; }
                            100% { transform: scale(0) rotate(360deg); opacity: 0; }
                        }
                    `;
                    document.head.appendChild(style);
                    
                    welcomeContent.appendChild(sparkle);
                    
                    setTimeout(() => {
                        if (sparkle.parentNode) {
                            sparkle.parentNode.removeChild(sparkle);
                        }
                    }, 2000);
                }, i * 100);
            }
        }

        // Initialize features
        function initializeFeatures() {
            document.getElementById('soundToggle').addEventListener('click', toggleSound);
            document.getElementById('infoButton').addEventListener('click', showInfoModal);
            document.getElementById('readmeButton').addEventListener('click', showReadmeModal);
            
            setInterval(showRandomMotivationalToast, 60000); // Every minute
            updateWeatherWidget();
            setInterval(updateWeatherWidget, 300000); // Every 5 minutes
        }

        // Sound system
        function toggleSound() {
            soundEnabled = !soundEnabled;
            const btn = document.getElementById('soundToggle');
            btn.textContent = soundEnabled ? 'üîä' : 'üîá';
            btn.title = soundEnabled ? 'Sound On' : 'Sound Off';
            if (soundEnabled) {
                playSound('toggle');
                showMotivationalToast("üîä", "Sound effects activated!");
            } else {
                showMotivationalToast("üîá", "Sound effects muted!");
            }
        }

        function playSound(type) {
            if (!soundEnabled) return;
            
            // Sound file mapping
            const soundFiles = {
                'welcome': 'sounds/welcome.mp3',
                'click': 'sounds/click.mp3',
                'success': 'sounds/success.mp3',
                'celebration': 'sounds/celebration.mp3',
                'battle': 'sounds/battle.mp3',
                'levelup': 'sounds/levelup.mp3',
                'achievement': 'sounds/achievement.mp3',
                'tick': 'sounds/tick.mp3',
                'toggle': 'sounds/toggle.mp3',
                'notification': 'sounds/notification.mp3',
                'whoosh': 'sounds/whoosh.mp3',
                'fanfare': 'sounds/fanfare.mp3'
            };
            
            const soundFile = soundFiles[type];
            if (soundFile) {
                const audio = new Audio(soundFile);
                audio.volume = 0.3; // Adjust volume (0.0 to 1.0)
                audio.play().catch(e => console.log(`Sound play failed for ${type}:`, e));
            }
            
            console.log(`üîä Playing ${type} sound effect`);
        }

        // Time display updates
        function startTimeUpdates() {
            updateTimes();
            setInterval(updateTimes, 1000);
        }

        function updateTimes() {
            const now = new Date();
            
            // Kuala Lumpur time (UTC+8) - betul punya calculation
            const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
            const klTime = new Date(utc + (8 * 3600000));
            
            document.getElementById('klTime').textContent = klTime.toLocaleTimeString('en-MY', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
            
            // Platform time (same as KL)
            document.getElementById('platformTime').textContent = klTime.toLocaleTimeString('en-MY', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
        }

        // Weather widget simulation
        function updateWeatherWidget() {
            if (globalData && globalData.dailyData) {
                const latestDate = Object.keys(globalData.dailyData).sort().reverse()[0];
                const dayData = globalData.dailyData[latestDate];
                
                if (dayData) {
                    const condition = dayData.weatherCondition || "Good";
                    
                    let emoji = "üå§Ô∏è";
                    if (condition.toLowerCase().includes("good")) emoji = "üå§Ô∏è";
                    if (condition.toLowerCase().includes("fair")) emoji = "‚õÖ";
                    if (condition.toLowerCase().includes("rough")) emoji = "‚õàÔ∏è";
                    
                    document.getElementById('weatherTemp').textContent = `${emoji} ${condition}`;
                    document.getElementById('weatherDesc').textContent = `Platform conditions: Optimal for work`;
                } else {
                    document.getElementById('weatherTemp').textContent = "üå§Ô∏è Good Weather";
                    document.getElementById('weatherDesc').textContent = "Platform conditions: Optimal for work";
                }
            }
        }

        // Floating particles effect
        function createFloatingParticles() {
            const particlesContainer = document.getElementById('particles');
            
            function createParticle() {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 10 + 's';
                particle.style.animationDuration = (10 + Math.random() * 10) + 's';
                
                particlesContainer.appendChild(particle);
                
                setTimeout(() => {
                    if (particlesContainer.contains(particle)) {
                        particlesContainer.removeChild(particle);
                    }
                }, 20000);
            }
            
            // Create initial particles
            for (let i = 0; i < 10; i++) {
                setTimeout(createParticle, i * 1000);
            }
            
            // Continue creating particles
            setInterval(createParticle, 2000);
        }

        // Motivational toast system
        function showRandomMotivationalToast() {
            const toast = motivationalToasts[Math.floor(Math.random() * motivationalToasts.length)];
            showMotivationalToast(toast.icon, toast.text);
        }

        function showMotivationalToast(icon, message) {
            const toastElement = document.getElementById('motivationalToast');
            const iconElement = toastElement.querySelector('.toast-icon');
            const messageElement = document.getElementById('toastMessage');
            
            iconElement.textContent = icon;
            messageElement.textContent = message;
            
            toastElement.classList.add('show');
            
            setTimeout(() => {
                toastElement.classList.remove('show');
            }, 3000);
        }

        // Food mood system
        function getFoodMood(completionRate) {
            for (let rate of Object.keys(foodMoods).sort((a, b) => b - a)) {
                if (completionRate >= parseInt(rate)) {
                    return foodMoods[rate];
                }
            }
            return foodMoods[0];
        }

        // Export functionality
        function exportReport() {
            if (!globalData) {
                showMotivationalToast("üìã", "No data to export! Load some activity data first!");
                return;
            }
            
            const workGroupStats = calculateWorkGroupStats();
            const rankedGroups = assignRankings(workGroupStats);
            
            const report = {
                timestamp: new Date().toISOString(),
                location: "Daily Coordination Meeting Platform",
                calculationMethod: {
                    description: "Work group rankings based on average progress percentage",
                    formula: "Sum of all activity progress values √∑ Number of activities per group",
                    example: "Operations: (10% + 0% + 5%) √∑ 3 = 5% average"
                },
                summary: {
                    totalGroups: rankedGroups.length,
                    champion: rankedGroups[0]?.groupName || "N/A",
                    championRate: rankedGroups[0]?.stats.averageProgress || 0,
                    averageCompletion: Math.round(rankedGroups.reduce((sum, g) => sum + g.stats.averageProgress, 0) / rankedGroups.length)
                },
                rankings: rankedGroups.map(group => ({
                    rank: group.rank,
                    groupName: group.groupName,
                    averageProgress: group.stats.averageProgress,
                    totalActivities: group.stats.total,
                    completedActivities: group.stats.completed,
                    tier: group.tier.title,
                    energyLevel: getFoodMood(group.stats.averageProgress).desc
                }))
            };
            
            const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `meeting-performance-report-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showMotivationalToast("üìã", "Performance report exported successfully!");
            playSound('success');
        }

        function setupFileUpload() {
            console.log("üìÅ Setting up file upload...");
            const fileInput = document.getElementById('jsonInput');
            
            if (!fileInput) {
                console.error("‚ùå File input not found!");
                return;
            }
            
            fileInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    console.log("üìÑ File selected:", file.name);
                    
                    // Update welcome status if welcome prompt is visible
                    const welcomePrompt = document.getElementById('welcomePrompt');
                    if (welcomePrompt && !welcomePrompt.classList.contains('fade-out')) {
                        updateWelcomeStatus(`Loading ${file.name}...`, "info");
                    }
                    
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            globalData = JSON.parse(e.target.result);
                            console.log("‚úÖ Activity data loaded:", globalData);
                            
                            // Hide welcome prompt if visible
                            if (welcomePrompt && !welcomePrompt.classList.contains('fade-out')) {
                                updateWelcomeStatus("Data loaded! Starting awards ceremony...", "success");
                                setTimeout(() => {
                                    hideWelcomePrompt();
                                    setTimeout(() => {
                                        startAwardsCeremony();
                                    }, 1000);
                                }, 1500);
                            } else {
                                // Direct start if welcome prompt already hidden
                                startAwardsCeremony();
                            }
                            
                            updateUploadStatus("‚úÖ Activity data loaded! Starting awards ceremony...", "success");
                            playSound('success');
                        } catch (error) {
                            console.error("‚ùå JSON parse error:", error);
                            const errorMsg = "‚ùå File format error: " + error.message;
                            updateUploadStatus(errorMsg, "error");
                            updateWelcomeStatus(errorMsg, "error");
                            showMotivationalToast("‚ö†Ô∏è", "File has issues! Check your JSON format!");
                        }
                    };
                    reader.readAsText(file);
                }
            });
            console.log("‚úÖ File upload setup complete");
        }

        function setupPopupEvents() {
            console.log("üé≠ Setting up popup events...");
            
            const overlay = document.getElementById('popupOverlay');
            const infoOverlay = document.getElementById('infoOverlay');
            const readmeOverlay = document.getElementById('readmeOverlay');
            
            if (!overlay || !infoOverlay || !readmeOverlay) {
                console.error("‚ùå Popup overlays not found!");
                return;
            }
            
            // Close on overlay click
            overlay.addEventListener('click', function(e) {
                if (e.target === overlay) closePopup();
            });
            
            infoOverlay.addEventListener('click', function(e) {
                if (e.target === infoOverlay) closeInfoModal();
            });
            
            readmeOverlay.addEventListener('click', function(e) {
                if (e.target === readmeOverlay) closeReadmeModal();
            });
            
            // Keyboard events
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    if (overlay.classList.contains('active')) closePopup();
                    if (infoOverlay.classList.contains('active')) closeInfoModal();
                    if (readmeOverlay.classList.contains('active')) closeReadmeModal();
                }
            });
            
            console.log("‚úÖ Popup events setup complete");
        }

        function showReadmeModal() {
            console.log("üìñ Showing user guide modal");
            const readmeOverlay = document.getElementById('readmeOverlay');
            if (readmeOverlay) {
                readmeOverlay.classList.add('active');
                playSound('click');
            }
        }

        function closeReadmeModal() {
            const readmeOverlay = document.getElementById('readmeOverlay');
            if (readmeOverlay) {
                readmeOverlay.classList.remove('active');
                console.log("‚úÖ User guide modal closed");
            }
        }

        function showInfoModal() {
            console.log("üìä Showing info modal");
            const infoOverlay = document.getElementById('infoOverlay');
            if (infoOverlay) {
                infoOverlay.classList.add('active');
                playSound('click');
            }
        }

        function closeInfoModal() {
            const infoOverlay = document.getElementById('infoOverlay');
            if (infoOverlay) {
                infoOverlay.classList.remove('active');
                console.log("‚úÖ Info modal closed");
            }
        }

        function showPopup(group) {
            console.log("üé≠ Showing popup for:", group.groupName);
            
            const overlay = document.getElementById('popupOverlay');
            if (!overlay) {
                console.error("‚ùå Popup overlay not found!");
                return;
            }
            
            try {
                const randomQuote = group.tier.quotes[Math.floor(Math.random() * group.tier.quotes.length)];
                
                document.getElementById('popupIcon').textContent = group.tier.icon;
                document.getElementById('popupTitle').textContent = group.tier.title;
                document.getElementById('popupGroupName').textContent = group.groupName;
                document.getElementById('popupStats').textContent = `${group.stats.averageProgress}%`;
                document.getElementById('popupQuote').textContent = `"${randomQuote}"`;
                
                const popupStats = document.getElementById('popupStats');
                const popupTitle = document.getElementById('popupTitle');
                if (group.rank === 1) {
                    popupStats.style.color = '#fbbf24';
                    popupTitle.style.color = '#fbbf24';
                } else {
                    popupStats.style.color = '#0ea5e9';
                    popupTitle.style.color = '#fbbf24';
                }
                
                overlay.classList.add('active');
                console.log("‚úÖ Popup shown");
                playSound('celebration');
                
                setTimeout(() => {
                    if (overlay.classList.contains('active')) {
                        closePopup();
                    }
                }, 5000);
                
            } catch (error) {
                console.error("‚ùå Error showing popup:", error);
            }
        }

        function closePopup() {
            const overlay = document.getElementById('popupOverlay');
            if (overlay) {
                overlay.classList.remove('active');
                console.log("‚úÖ Popup closed");
            }
        }

        function updateUploadStatus(message, type) {
            const status = document.getElementById('uploadStatus');
            if (status) {
                status.textContent = message;
                status.style.color = type === 'success' ? '#0ea5e9' : '#ef4444';
            }
        }

        function showDefaultState() {
            console.log("üèóÔ∏è Showing default state...");
            
            // Create placeholder data for demonstration
            const placeholderGroups = [];
            
            // Generate placeholder groups using tiers
            for (let i = 0; i < 6; i++) {
                const tier = performanceTiers[i];
                const rank = i + 1;
                
                let averageProgress, groupName;
                
                switch(rank) {
                    case 1:
                        averageProgress = 95;
                        groupName = "Operations";
                        break;
                    case 2:
                        averageProgress = 88;
                        groupName = "Maintenance";
                        break;
                    case 3:
                        averageProgress = 82;
                        groupName = "QC Team";
                        break;
                    case 4:
                        averageProgress = 75;
                        groupName = "HMM Construction";
                        break;
                    case 5:
                        averageProgress = 68;
                        groupName = "HMM Painting";
                        break;
                    case 6:
                        averageProgress = 60;
                        groupName = "Others";
                        break;
                }
                
                placeholderGroups.push({
                    groupName: groupName,
                    stats: {
                        averageProgress: averageProgress,
                        completed: Math.floor(averageProgress / 20),
                        inProgress: Math.floor((100 - averageProgress) / 30),
                        total: 5
                    },
                    rank: rank,
                    tier: tier,
                    isPlaceholder: true
                });
            }
            
            console.log("üìä Created placeholder groups:", placeholderGroups.length);
            
            // Update champion sections with placeholder data
            updateChampionSections(placeholderGroups);
            updatePerformanceBoxes(placeholderGroups);
            
            // Show placeholder achievements
            const achievementsGrid = document.getElementById('achievementsGrid');
            if (achievementsGrid) {
                achievementsGrid.innerHTML = `
                    <div class="achievement-box">
                        <div class="achievement-date">Today</div>
                        <div class="achievement-count">24</div>
                        <div class="achievement-label">Total Activities</div>
                        <div class="food-motivator">üçõ Nasi lemak power!</div>
                    </div>
                    <div class="achievement-box">
                        <div class="achievement-date">Completed</div>
                        <div class="achievement-count">18</div>
                        <div class="achievement-label">Tasks Done</div>
                        <div class="food-motivator">üçú Mee goreng momentum!</div>
                    </div>
                    <div class="achievement-box">
                        <div class="achievement-date">In Progress</div>
                        <div class="achievement-count">6</div>
                        <div class="achievement-label">Ongoing</div>
                        <div class="food-motivator">ü•ò Rendang reliable!</div>
                    </div>
                    <div class="achievement-box">
                        <div class="achievement-date">Average</div>
                        <div class="achievement-count">78%</div>
                        <div class="achievement-label">Progress</div>
                        <div class="food-motivator">üç≤ Curry confidence!</div>
                    </div>
                `;
            }
            
            console.log("‚úÖ Default state shown");
        }

        function updateDashboard() {
            console.log("üîÑ Updating dashboard...");
            if (!globalData) {
                console.error("‚ùå No global data available");
                return;
            }
            
            try {
                const workGroupStats = calculateWorkGroupStats();
                const rankedGroups = assignRankings(workGroupStats);
                
                console.log("üìä Ranked groups:", rankedGroups.length);
                
                updateChampionSections(rankedGroups);
                updatePerformanceBoxes(rankedGroups);
                updateAchievements();
                updateSmartPredictions();
                checkForNewAchievements();
                updateWeatherWidget();
                
                console.log("‚úÖ Dashboard updated successfully");
            } catch (error) {
                console.error("‚ùå Error updating dashboard:", error);
            }
        }

function calculateWorkGroupStats() {
    // Support both Sept (workActivities) and Oct (performanceDeck) format
    const activities = globalData?.workActivities || globalData?.performanceDeck || [];
    
    if (!globalData || activities.length === 0) {
        console.log("üìä No work activities data");
        return {};
    }
    
    const workGroups = {};
    
    // Group activities by work group and calculate average progress
    activities.forEach(activity => {
        const workGroup = activity.workGroup;
        
        if (!workGroups[workGroup]) {
            workGroups[workGroup] = { 
                total: 0, 
                completed: 0, 
                inProgress: 0,
                totalProgress: 0,
                averageProgress: 0
            };
        }
        
        workGroups[workGroup].total++;
        
        // Use actual progress percentage
        const progress = activity.progress || 0;
        workGroups[workGroup].totalProgress += progress;
        
        if (activity.status === 'Completed' || progress === 100) {
            workGroups[workGroup].completed++;
        } else if (activity.status === 'In Progress' || progress > 0) {
            workGroups[workGroup].inProgress++;
        }
    });
    
    // Calculate average progress rates
    Object.keys(workGroups).forEach(group => {
        const stats = workGroups[group];
        stats.averageProgress = stats.total > 0 ? 
            Math.round(stats.totalProgress / stats.total) : 0;
    });
    
    return workGroups;
}

        function assignRankings(workGroupStats) {
            const sortedGroups = Object.entries(workGroupStats)
                .sort(([,a], [,b]) => b.averageProgress - a.averageProgress);
            
            const rankedGroups = sortedGroups.map(([groupName, stats], index) => ({
                groupName,
                stats,
                rank: index + 1,
                tier: getPerformanceTierByRank(index + 1)
            }));
            
            console.log(`üìä Ranked groups created: ${rankedGroups.length}`);
            
            return rankedGroups;
        }

        function getPerformanceTierByRank(rank) {
            const tier = performanceTiers.find(t => t.rank === rank);
            if (!tier) {
                return performanceTiers[performanceTiers.length - 1]; // Default to last tier
            }
            return tier;
        }

        function updateChampionSections(rankedGroups) {
            if (rankedGroups.length > 0) {
                const champion = rankedGroups[0];
                const championElement = document.getElementById('championToday');
                
                if (championElement) {
                    championElement.style.display = 'block';
                    
                    const foodMood = getFoodMood(champion.stats.averageProgress);
                    document.getElementById('championFoodMood').textContent = foodMood.emoji;
                    document.getElementById('championFoodMood').title = foodMood.desc;
                    
                    document.getElementById('championName').textContent = 
                        champion.groupName.length > 20 ? champion.groupName.substring(0, 20) + '...' : champion.groupName;
                    document.getElementById('championStats').textContent = `${champion.stats.averageProgress}%`;
                    document.getElementById('championIcon').textContent = champion.tier.icon;
                    
                    const randomQuote = champion.tier.quotes[Math.floor(Math.random() * champion.tier.quotes.length)];
                    document.getElementById('championQuote').textContent = `"${randomQuote}"`;
                    
                    championElement.onclick = function() {
                        console.log("üèÜ Champion clicked!");
                        showPopup(champion);
                        showCelebration("üëë");
                        triggerWisdom();
                        playSound('celebration');
                        
                        // Show battle mode option
                        setTimeout(() => {
                            if (confirm("Start Team Battle Mode? ‚öîÔ∏è")) {
                                startTeamBattle();
                            }
                        }, 1000);
                    };
                }
                
                const overallElement = document.getElementById('championOverall');
                if (overallElement) {
                    overallElement.style.display = 'block';
                    
                    document.getElementById('overallLeaderName').textContent = 
                        champion.groupName.length > 18 ? champion.groupName.substring(0, 18) + '...' : champion.groupName;
                    document.getElementById('overallStats').textContent = `${champion.stats.averageProgress}%`;
                    
                    let reason = "Consistent excellence across all activities";
                    if (champion.stats.averageProgress === 100) {
                        reason = "Perfect execution, zero compromises!";
                    } else if (champion.stats.averageProgress >= 90) {
                        reason = "Outstanding performance, industry leader!";
                    } else if (champion.stats.averageProgress >= 80) {
                        reason = "Strong performance, reliable delivery!";
                    } else {
                        reason = `Leading with ${champion.stats.averageProgress}% average progress`;
                    }
                    
                    document.getElementById('overallReason').textContent = reason;
                    
                    const classyQuotes = [
                        "Fast like lightning, steady like sunrise! ‚ö°üåÖ",
                        "Performance so smooth, even silk is jealous! üé≠‚ú®",
                        "Excellence level: chef's kiss perfection! üë®‚Äçüç≥üíã",
                        "Class and performance: perfect combination! üé©‚ö°"
                    ];
                    
                    const randomClassyQuote = classyQuotes[Math.floor(Math.random() * classyQuotes.length)];
                    document.getElementById('overallQuote').textContent = `"${randomClassyQuote}"`;
                    
                    overallElement.onclick = function() {
                        console.log("üèéÔ∏è Performance Leader clicked!");
                        showPopup(champion);
                        showCelebration("üèéÔ∏è");
                        triggerWisdom();
                        playSound('celebration');
                    };
                }
            }
        }

        // Update performance boxes with intervention support
        function updatePerformanceBoxes(rankedGroups) {
            console.log("üéØ Updating performance boxes, total groups:", rankedGroups.length);
            
            const middleRow = document.getElementById('middleRow');
            const lowerRow = document.getElementById('lowerRow');
            const ghostRow = document.getElementById('ghostRow');
            
            // Clear all rows
            if (middleRow) middleRow.innerHTML = '';
            if (lowerRow) lowerRow.innerHTML = '';
            if (ghostRow) ghostRow.innerHTML = '';
            
            // Middle row - ranks 2, 3, 4
            if (rankedGroups.length >= 4) {
                [1, 2, 3].forEach(index => {
                    const group = rankedGroups[index];
                    if (group && middleRow) {
                        middleRow.appendChild(createPerformanceCard(group, rankedGroups));
                    }
                });
            }
            
            // Lower row - ranks 5, 6
            if (rankedGroups.length >= 5) {
                for (let i = 4; i < Math.min(rankedGroups.length, 6); i++) {
                    const group = rankedGroups[i];
                    if (group && lowerRow) {
                        lowerRow.appendChild(createPerformanceCard(group, rankedGroups));
                    }
                }
            }
            
            // NEW: Ghost row - intervention box for ranks 7+
            if (rankedGroups.length >= 7) {
                const interventionTeams = rankedGroups.slice(6); // Rank 7 and below
                if (ghostRow) {
                    ghostRow.appendChild(createInterventionBox(interventionTeams));
                }
            }
            
            console.log("‚úÖ Performance boxes updated successfully");
        }

        // NEW: Create intervention box for teams rank 7+
        function createInterventionBox(interventionTeams) {
            const box = document.createElement('div');
            box.className = 'intervention-box';
            
            // Professional intervention quotes with Malaysian humor
            const interventionQuotes = [
                "‚ö° Time for OIM magic touch! Emergency skill enhancement program loading... üéØ",
                "üìö Extended training module activated. Coffee-powered motivation session required! ‚òï",
                "üöÄ Performance rocket needs fuel injection. OIM to the rescue! üí™",
                "üé≠ Plot twist incoming! OIM intervention will transform these numbers! ‚ú®",
                "üìà From zero to hero training camp initiated. Watch this space! üî•",
                "‚öì All hands on deck! OIM special ops deployment in progress! üõ†Ô∏è",
                "üéØ Target practice mode engaged. Precision improvement workshop starts now! üìä",
                "üí° Lightbulb moment loading... OIM innovation session scheduled! üß†"
            ];
            
            const randomQuote = interventionQuotes[Math.floor(Math.random() * interventionQuotes.length)];
            
            // Create teams list HTML
            let teamsListHTML = '';
            interventionTeams.forEach(team => {
                teamsListHTML += `
                    <div class="intervention-team">
                        <div>
                            <span class="intervention-team-rank">#${team.rank}</span>
                            <span class="intervention-team-name">${team.groupName.length > 15 ? team.groupName.substring(0, 15) + '...' : team.groupName}</span>
                        </div>
                        <span class="intervention-team-percent">${team.stats.averageProgress}%</span>
                    </div>
                `;
            });
            
            box.innerHTML = `
                <div class="intervention-icons">üê¢üêåüìã</div>
                <div class="intervention-title">OIM INTERVENTION REQUIRED</div>
                <div class="intervention-teams">
                    <div style="text-align: center; font-weight: bold; color: #fbbf24; margin-bottom: 10px; font-size: 0.9em;">
                        MOTIVATION ZONE (${interventionTeams.length} teams)
                    </div>
                    ${teamsListHTML}
                </div>
                <div class="intervention-quote">${randomQuote}</div>
                <div class="intervention-action">üé™ OIM Special Program Required</div>
            `;
            
            // Add click event for intervention box
            box.addEventListener('click', function() {
                console.log("üé≠ Intervention box clicked!");
                showInterventionPopup(interventionTeams);
                showCelebration("üÜò");
                triggerWisdom();
                playSound('click');
            });
            
            return box;
        }

        // NEW: Show intervention popup
        function showInterventionPopup(interventionTeams) {
            console.log("üÜò Showing intervention popup for teams:", interventionTeams.length);
            
            const overlay = document.getElementById('popupOverlay');
            if (!overlay) {
                console.error("‚ùå Popup overlay not found!");
                return;
            }
            
            try {
                // Intervention-specific motivational messages
                const interventionMessages = [
                    "Every champion was once a beginner! üåü These teams are diamonds in the rough waiting to shine! Time for OIM mentoring magic! ‚ú®",
                    "Rome wasn't built in a day, but they were laying bricks every hour! üß± These teams need OIM guidance to start building their success story! üèóÔ∏è",
                    "Even the best smartphones need software updates! üì± Time for OIM to upgrade these teams with new skills and motivation! üöÄ",
                    "Coffee needs time to brew to perfection! ‚òï These teams need OIM brewing session to reach their full potential! üí™",
                    "Every rocket needs ground support before launch! üöÄ OIM mission control needed for these teams' takeoff sequence! üéØ"
                ];
                
                const randomMessage = interventionMessages[Math.floor(Math.random() * interventionMessages.length)];
                
                // Create detailed team list
                let detailedTeamsList = '';
                interventionTeams.forEach(team => {
                    const foodMood = getFoodMood(team.stats.averageProgress);
                    detailedTeamsList += `
                        <div style="background: rgba(0,0,0,0.3); padding: 12px; margin: 8px 0; border-radius: 8px; border-left: 3px solid #ef4444;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <span style="color: #fbbf24; font-weight: bold;">Rank #${team.rank}</span> - 
                                    <span style="color: #e5e7eb; font-weight: 500;">${team.groupName}</span>
                                </div>
                                <div>
                                    <span style="color: #ef4444; font-weight: bold; font-size: 1.1em;">${team.stats.averageProgress}%</span>
                                    <span style="margin-left: 8px;">${foodMood.emoji}</span>
                                </div>
                            </div>
                            <div style="margin-top: 5px; font-size: 0.85em; color: #94a3b8;">
                                Activities: ${team.stats.completed} completed, ${team.stats.inProgress} in progress, ${team.stats.total} total
                            </div>
                            <div style="margin-top: 5px; font-size: 0.8em; color: #fbbf24; font-style: italic;">
                                Status: ${foodMood.desc}
                            </div>
                        </div>
                    `;
                });
                
                document.getElementById('popupIcon').textContent = 'üÜò';
                document.getElementById('popupTitle').textContent = 'OIM INTERVENTION REQUIRED';
                document.getElementById('popupGroupName').innerHTML = `
                    <div style="color: #e2e8f0; margin-bottom: 15px;">
                        ${interventionTeams.length} teams requiring immediate attention
                    </div>
                    ${detailedTeamsList}
                `;
                document.getElementById('popupStats').textContent = 'MOTIVATION ZONE';
                document.getElementById('popupQuote').innerHTML = `
                    <div style="text-align: left;">
                        <div style="margin-bottom: 15px;">"${randomMessage}"</div>
                        <div style="background: rgba(251, 191, 36, 0.1); padding: 10px; border-radius: 6px; border-left: 3px solid #fbbf24;">
                            <strong style="color: #fbbf24;">üéØ OIM Action Plan:</strong><br>
                            ‚Ä¢ Individual team consultation sessions<br>
                            ‚Ä¢ Skills assessment and training program<br>
                            ‚Ä¢ Motivational support and resource allocation<br>
                            ‚Ä¢ Progress monitoring and milestone celebration
                        </div>
                    </div>
                `;
                
                // Style the popup for intervention theme
                const popupStats = document.getElementById('popupStats');
                const popupTitle = document.getElementById('popupTitle');
                popupStats.style.color = '#ef4444';
                popupTitle.style.color = '#ef4444';
                
                overlay.classList.add('active');
                console.log("‚úÖ Intervention popup shown");
                playSound('notification');
                
                setTimeout(() => {
                    if (overlay.classList.contains('active')) {
                        closePopup();
                    }
                }, 10000); // Show longer for intervention popup
                
            } catch (error) {
                console.error("‚ùå Error showing intervention popup:", error);
            }
        }

        function createPerformanceCard(group, rankedGroups) {
            const card = document.createElement('div');
            const rankClass = group.rank <= 3 ? `rank-${group.rank}` : 
                             group.rank >= 5 ? 'bottom-tier' : '';
            card.className = `performance-card ${rankClass}`;
            
            const randomQuote = group.tier.quotes[Math.floor(Math.random() * group.tier.quotes.length)];
            
            const firstPlaceRate = rankedGroups && rankedGroups.length > 0 ? rankedGroups[0].stats.averageProgress : 100;
            const distanceFromFirst = firstPlaceRate - group.stats.averageProgress;
            
            let badgeClass = 'default';
            if (group.rank <= 3) badgeClass = `rank-${group.rank}`;
            
            const foodMood = getFoodMood(group.stats.averageProgress);
            
            const placeholderStyle = group.isPlaceholder ? 'opacity: 0.7; border-style: dashed;' : '';
            card.style.cssText = placeholderStyle;
            
            const taskSummary = group.isPlaceholder ? 
                "‚ö†Ô∏è Awaiting activity assignment" :
                `‚úÖ ${group.stats.completed} ‚Ä¢ üîÑ ${group.stats.inProgress} ‚Ä¢ üìä Avg: ${group.stats.averageProgress}%`;
            
            // Performance trend based on average progress
            let trendDisplay = "";
            if (group.stats.averageProgress >= 80) {
                trendDisplay = '<span class="trend-up">üìà Rising performance!</span>';
            } else if (group.stats.averageProgress >= 60) {
                trendDisplay = '<span class="trend-stable">üéØ Steady progress!</span>';
            } else {
                trendDisplay = '<span class="trend-down">‚òï Need motivation boost!</span>';
            }
            
            card.innerHTML = `
                <div class="food-mood">${foodMood.emoji}</div>
                <div class="rank-badge ${badgeClass}">${group.rank}</div>
                <div class="performance-icon">${group.tier.icon}</div>
                <div class="performance-title">${group.tier.title}</div>
                <div class="performance-stats">${group.stats.averageProgress}%</div>
                <div class="work-group-name">
                    ${group.groupName.length > 20 ? group.groupName.substring(0, 20) + '...' : group.groupName}
                </div>
                <div class="team-level">
                    <span class="level-badge">LVL ${getTeamLevel(group.groupName)}</span>
                    <div class="level-progress">
                        <div class="level-progress-fill" style="width: ${(getTeamXP(group.groupName) % 1000) / 10}%"></div>
                    </div>
                </div>
                ${getSpecialTitle(group.groupName) ? `<div class="special-title" style="position: relative; top: 0; transform: none; margin: 5px 0; font-size: 0.7em;">${getSpecialTitle(group.groupName)}</div>` : ''}
                ${createPerformanceChart(group.groupName)}
                <div class="task-summary">
                    ${taskSummary}
                </div>
                <div class="performance-trend">
                    ${trendDisplay}
                </div>
                <div class="distance-from-first">
                    ${group.isPlaceholder ? 'Demo Mode Active' : 
                      (distanceFromFirst > 0 ? `-${distanceFromFirst}% from #1` : 'Leading the pack!')}
                </div>
                <div class="offshore-quote">"${randomQuote}"</div>
                <div class="food-motivator">${foodMood.desc}</div>
            `;
            
            card.addEventListener('click', function() {
                console.log("üéØ Performance card clicked:", group.groupName);
                showPopup(group);
                showCelebration(group.tier.icon);
                triggerWisdom();
                playSound('click');
            });
            
            return card;
        }

function updateAchievements() {
    // Support both Sept (workActivities) and Oct (performanceDeck) format
    const activities = globalData?.workActivities || globalData?.performanceDeck || [];
    
    if (!globalData || activities.length === 0) {
        console.log("üìà No work activities data, keeping placeholder achievements");
        return;
    }
    
    const totalActivities = activities.length;
    const completedActivities = activities.filter(a => a.status === 'Completed' || a.progress === 100).length;
    const inProgressActivities = activities.filter(a => a.status === 'In Progress' || (a.progress > 0 && a.progress < 100)).length;
    
    // Calculate average progress across all activities
    const totalProgress = activities.reduce((sum, activity) => sum + (activity.progress || 0), 0);
    const averageCompletion = totalActivities > 0 ? Math.round(totalProgress / totalActivities) : 0;
    
    const achievementsGrid = document.getElementById('achievementsGrid');
    if (!achievementsGrid) return;
    
    let energyMotivator = "";
    if (averageCompletion >= 80) {
        energyMotivator = "üçõ Nasi lemak power level!";
    } else if (averageCompletion >= 60) {
        energyMotivator = "üçú Mee goreng momentum!";
    } else if (averageCompletion >= 40) {
        energyMotivator = "ü•ò Rendang reliable!";
    } else {
        energyMotivator = "‚òï Need energy boost!";
    }
    
    achievementsGrid.innerHTML = `
        <div class="achievement-box">
            <div class="achievement-date">Today</div>
            <div class="achievement-count">${totalActivities}</div>
            <div class="achievement-label">Total Activities</div>
            <div class="food-motivator">üìã Full schedule!</div>
        </div>
        <div class="achievement-box">
            <div class="achievement-date">Completed</div>
            <div class="achievement-count">${completedActivities}</div>
            <div class="achievement-label">Tasks Done</div>
            <div class="food-motivator">‚úÖ Success stories!</div>
        </div>
        <div class="achievement-box">
            <div class="achievement-date">In Progress</div>
            <div class="achievement-count">${inProgressActivities}</div>
            <div class="achievement-label">Ongoing</div>
            <div class="food-motivator">üîÑ Active work!</div>
        </div>
        <div class="achievement-box">
            <div class="achievement-date">Overall</div>
            <div class="achievement-count">${averageCompletion}%</div>
            <div class="achievement-label">Progress</div>
            <div class="food-motivator">${energyMotivator}</div>
        </div>
    `;
}

        function setupWisdomCorner() {
            const wisdomElement = document.getElementById('wisdomCorner');
            if (wisdomElement) {
                wisdomElement.addEventListener('click', () => {
                    triggerWisdom();
                    playSound('click');
                });
                setInterval(triggerWisdom, 45000);
                triggerWisdom();
            }
        }

        function triggerWisdom() {
            const randomWisdom = platformWisdom[Math.floor(Math.random() * platformWisdom.length)];
            const wisdomText = document.getElementById('wisdomText');
            if (wisdomText) {
                wisdomText.textContent = randomWisdom;
            }
            
            const wisdomElement = document.getElementById('wisdomCorner');
            if (wisdomElement) {
                wisdomElement.style.transform = 'translateY(-3px)';
                setTimeout(() => {
                    wisdomElement.style.transform = 'translateY(0)';
                }, 300);
            }
        }

        function showCelebration(emoji) {
            const celebration = document.createElement('div');
            celebration.className = 'celebration';
            celebration.textContent = emoji;
            document.body.appendChild(celebration);
            
            setTimeout(() => {
                if (document.body.contains(celebration)) {
                    document.body.removeChild(celebration);
                }
            }, 2000);
        }

        // Achievement System Functions
        function initializeAchievementSystem() {
            console.log("üèÜ Initializing achievement system...");
            achievementData = achievementData || {};
            updateAchievementDisplay();
            setInterval(checkForNewAchievements, 30000);
        }
        
        function updateAchievementDisplay() {
            const badgeGrid = document.getElementById('badgeGrid');
            if (!badgeGrid) return;
            
            badgeGrid.innerHTML = '';
            
            availableAchievements.forEach(achievement => {
                const badge = document.createElement('div');
                badge.className = `badge ${achievementData[achievement.id] ? 'unlocked' : 'locked'}`;
                badge.textContent = achievement.icon;
                badge.title = `${achievement.name}: ${achievement.description}`;
                
                if (achievementData[achievement.id]) {
                    badge.addEventListener('click', () => {
                        showMotivationalToast(achievement.icon, `${achievement.name} achieved! ${achievement.description}`);
                        playSound('celebration');
                    });
                }
                
                badgeGrid.appendChild(badge);
            });
        }
        
        function checkForNewAchievements() {
            if (!globalData || !performanceHistory) return;
            
            const rankedGroups = assignRankings(calculateWorkGroupStats());
            
            rankedGroups.forEach(group => {
                const groupHistory = performanceHistory[group.groupName] || [];
                
                availableAchievements.forEach(achievement => {
                    if (!achievementData[achievement.id] && achievement.condition(groupHistory)) {
                        unlockAchievement(achievement.id, group.groupName);
                    }
                });
            });
        }
        
        function unlockAchievement(achievementId, groupName) {
            achievementData[achievementId] = {
                unlockedBy: groupName,
                unlockedAt: new Date().toISOString(),
                description: availableAchievements.find(a => a.id === achievementId)?.description
            };
            
            const achievement = availableAchievements.find(a => a.id === achievementId);
            showMotivationalToast(achievement.icon, `üéâ NEW ACHIEVEMENT! ${achievement.name} unlocked by ${groupName}!`);
            showCelebration(achievement.icon);
            playSound('celebration');
            
            updateAchievementDisplay();
        }
        
        // Achievement condition functions
        function checkConsecutiveDays(history, targetRate, days) {
            if (history.length < days) return false;
            const recent = history.slice(-days);
            return recent.every(day => day.averageProgress >= targetRate);
        }
        
        function checkComebackStory(history) {
            if (history.length < 2) return false;
            const yesterday = history[history.length - 2];
            const today = history[history.length - 1];
            return yesterday.rank >= 5 && today.rank === 1;
        }
        
        function checkConsistency(history, minRate, days) {
            if (history.length < days) return false;
            const recent = history.slice(-days);
            return recent.every(day => day.averageProgress >= minRate);
        }
        
        function checkQuickCompletion(history) {
            if (history.length < 1) return false;
            const today = history[history.length - 1];
            return today.averageProgress === 100 && today.completedInHours <= 6;
        }
        
        function checkMaintenanceExcellence(history) {
            return history.some(day => day.groupName === 'Maintenance' && day.averageProgress >= 90);
        }
        
        function checkOperationsExcellence(history) {
            return history.some(day => day.groupName === 'Operations' && day.averageProgress >= 90);
        }
        
        function checkQCPerfection(history) {
            return history.some(day => day.groupName === 'QC Team' && day.averageProgress === 100);
        }
        
        function checkWeekendPerformance(history) {
            const weekendDays = history.filter(day => {
                const date = new Date(day.date);
                const dayOfWeek = date.getDay();
                return dayOfWeek === 0 || dayOfWeek === 6;
            });
            
            if (weekendDays.length < 2) return false;
            
            const avgWeekend = weekendDays.reduce((sum, day) => sum + day.averageProgress, 0) / weekendDays.length;
            return avgWeekend >= 80;
        }
        
        function checkRocketProgress(history) {
            if (history.length < 7) return false;
            const weekAgo = history[history.length - 7];
            const today = history[history.length - 1];
            return (today.averageProgress - weekAgo.averageProgress) >= 40;
        }
        
        // Performance History & Charts
        function initializePerformanceHistory() {
            console.log("üìà Initializing performance history...");
            
            const groups = ['Operations', 'Maintenance', 'QC Team', 'HMM Construction'];
            
            groups.forEach(groupName => {
                performanceHistory[groupName] = generateMockHistory(groupName);
            });
        }
        
        function generateMockHistory(groupName) {
            const history = [];
            const basePerformance = Math.random() * 30 + 50; // 50-80% base
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                
                const variance = (Math.random() - 0.5) * 20;
                const performance = Math.max(0, Math.min(100, basePerformance + variance + (Math.random() * 15)));
                
                history.push({
                    date: date.toISOString().split('T')[0],
                    averageProgress: Math.round(performance),
                    rank: Math.floor(Math.random() * 6) + 1,
                    completedInHours: Math.floor(Math.random() * 8) + 4,
                    groupName: groupName
                });
            }
            
            return history;
        }
        
        function createPerformanceChart(groupName) {
            const history = performanceHistory[groupName] || [];
            if (history.length === 0) return '';
            
            const maxRate = Math.max(...history.map(h => h.averageProgress));
            const points = history.map((point, index) => {
                const x = (index / (history.length - 1)) * 100;
                const y = 100 - (point.averageProgress / maxRate) * 100;
                return `${x},${y}`;
            }).join(' ');
            
            const areaPoints = `0,100 ${points} 100,100`;
            
            const trendDirection = history[history.length - 1].averageProgress > history[0].averageProgress ? 'up' : 'down';
            const trendEmoji = trendDirection === 'up' ? 'üìà' : 'üìâ';
            const trendText = trendDirection === 'up' ? 'Trending upward!' : 'Needs motivation boost!';
            
            return `
                <div class="performance-chart">
                    <svg width="100%" height="40" viewBox="0 0 100 100" preserveAspectRatio="none">
                        <defs>
                            <linearGradient id="chartGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#0ea5e9;stop-opacity:0.5" />
                                <stop offset="100%" style="stop-color:#0ea5e9;stop-opacity:0.1" />
                            </linearGradient>
                        </defs>
                        <polygon class="chart-area" points="${areaPoints}" />
                        <polyline class="chart-line" points="${points}" />
                    </svg>
                </div>
                <div style="font-size: 0.7em; color: #94a3b8; text-align: center;">
                    ${trendEmoji} 7-day trend: ${trendText}
                </div>
            `;
        }
        
        // Smart Predictions
        function updateSmartPredictions() {
            console.log("üîÆ Updating smart predictions...");
            
            const predictionsGrid = document.getElementById('predictionsGrid');
            if (!predictionsGrid) return;
            
            predictionsGrid.innerHTML = '';
            
            if (!globalData) {
                // Show demo predictions
                predictionsGrid.innerHTML = `
                    <div class="prediction-card">
                        <span class="prediction-icon">üèÜ</span>
                        <div class="prediction-title">Championship Prediction</div>
                        <div class="prediction-text">Operations team likely to maintain lead with 87% confidence based on current completion patterns and consistent progress trends.</div>
                        <div class="prediction-confidence">AI Confidence: 87%</div>
                    </div>
                    <div class="prediction-card">
                        <span class="prediction-icon">üå§Ô∏è</span>
                        <div class="prediction-title">Platform Conditions Forecast</div>
                        <div class="prediction-text">Optimal platform conditions expected. Activity completion may increase by 15%. Perfect day for outdoor maintenance work.</div>
                        <div class="prediction-confidence">Weather Confidence: 82%</div>
                    </div>
                    <div class="prediction-card">
                        <span class="prediction-icon">üìà</span>
                        <div class="prediction-title">Performance Trajectory</div>
                        <div class="prediction-text">Maintenance team showing strong upward trend. Expected to reach 85%+ completion by end of shift if current pace maintained.</div>
                        <div class="prediction-confidence">Trend Confidence: 78%</div>
                    </div>
                    <div class="prediction-card">
                        <span class="prediction-icon">üéØ</span>
                        <div class="prediction-title">Target Achievement Probability</div>
                        <div class="prediction-text">Overall targets achievable with 91% probability. QC Team needs extra focus - suggest additional quality checks.</div>
                        <div class="prediction-confidence">Success Probability: 91%</div>
                    </div>
                `;
                return;
            }
            
            const rankedGroups = assignRankings(calculateWorkGroupStats());
            
            predictionTemplates.forEach(template => {
                const prediction = template.generator(rankedGroups);
                const card = document.createElement('div');
                card.className = 'prediction-card';
                card.innerHTML = `
                    <span class="prediction-icon">${template.icon}</span>
                    <div class="prediction-title">${template.title}</div>
                    <div class="prediction-text">${prediction.text}</div>
                    <div class="prediction-confidence">${prediction.confidence}</div>
                `;
                predictionsGrid.appendChild(card);
            });
        }
        
        function generateChampionPrediction(groups) {
            const leader = groups[0];
            const challenger = groups[1];
            
            const leadMargin = leader.stats.averageProgress - challenger.stats.averageProgress;
            const confidence = Math.min(95, 60 + leadMargin);
            
            const predictions = [
                `${leader.groupName} leading championship with ${leadMargin}% margin over ${challenger.groupName}. Victory looking strong!`,
                `Current champion ${leader.groupName} facing challenge from rising ${challenger.groupName}. Competition is heating up!`,
                `${leader.groupName} cruising to victory unless ${challenger.groupName} pulls off surprise comeback!`
            ];
            
            return {
                text: predictions[Math.floor(Math.random() * predictions.length)],
                confidence: `AI Confidence: ${Math.round(confidence)}%`
            };
        }
        
        function generatePlatformPrediction(groups) {
            const platformEffects = [
                "Optimal platform conditions for all activities. Expect 20% boost in completion rates with perfect working environment!",
                "Good platform weather for all work. Indoor and outdoor activities equally favored. Productivity at maximum!",
                "Platform conditions stable. Perfect for maintenance activities. QC inspections proceed without weather delays.",
                "Excellent platform environment. All teams can operate at full capacity. Safety and efficiency guaranteed!",
                "Platform conditions ideal for construction work. Teams expected to complete activities ahead of schedule."
            ];
            
            const effect = platformEffects[Math.floor(Math.random() * platformEffects.length)];
            const confidence = Math.floor(Math.random() * 20) + 75; // 75-95%
            
            return {
                text: effect,
                confidence: `Weather Confidence: ${confidence}%`
            };
        }
        
        function generateTrendPrediction(groups) {
            const improvingGroups = groups.filter(g => g.stats.averageProgress > 70);
            const strugglingGroups = groups.filter(g => g.stats.averageProgress < 50);
            
            let prediction = "";
            
            if (improvingGroups.length > strugglingGroups.length) {
                prediction = `${improvingGroups[0].groupName} showing excellent trajectory. Expected to reach 90%+ by shift end if momentum continues.`;
            } else if (strugglingGroups.length > 0) {
                prediction = `${strugglingGroups[0].groupName} needs intervention. Trending downward - suggest immediate team consultation.`;
            } else {
                prediction = "All teams maintaining steady progress. Consistent performance across the board!";
            }
            
            const confidence = Math.floor(Math.random() * 20) + 70; // 70-90%
            
            return {
                text: prediction,
                confidence: `Trend Confidence: ${confidence}%`
            };
        }
        
        function generateTargetPrediction(groups) {
            const avgCompletion = groups.reduce((sum, g) => sum + g.stats.averageProgress, 0) / groups.length;
            const targetProbability = Math.min(95, avgCompletion + 15);
            
            const suggestions = [
                "suggest additional team focus sessions",
                "recommend extra coffee break for energy",
                "propose team building activities",
                "advise motivational speech by team lead",
                "suggest progress review meeting"
            ];
            
            const randomSuggestion = suggestions[Math.floor(Math.random() * suggestions.length)];
            
            const prediction = avgCompletion >= 75 
                ? `Overall targets highly achievable with current progress trends. Success rate looking very solid!`
                : `Targets achievable but require extra push. Lower performing teams need motivation boost - ${randomSuggestion}.`;
            
            return {
                text: prediction,
                confidence: `Success Probability: ${Math.round(targetProbability)}%`
            };
        }

        console.log("‚úÖ Daily Coordination Meeting Dashboard script loaded successfully!");
        
        // ========================================
        // AWARDS CEREMONY SYSTEM
        // ========================================
        
        function startAwardsCeremony() {
            console.log("üèÜ Starting Awards Ceremony sequence...");
            
            const ceremony = document.getElementById('awardsCeremony');
            ceremony.classList.add('active');
                        
            playSound('celebration');
            
            // Countdown sequence
            let countdown = 3;
            const countdownElement = document.getElementById('ceremonyCountdown');
            
            const countdownInterval = setInterval(() => {
                if (countdown > 0) {
                    countdownElement.textContent = countdown;
                    playSound('tick');
                    countdown--;
                } else {
                    countdownElement.textContent = "üéä";
                    clearInterval(countdownInterval);
                    
                    setTimeout(() => {
                        revealResults();
                    }, 1000);
                }
            }, 1000);
        }
        
        function revealResults() {
            const workGroupStats = calculateWorkGroupStats();
            const rankedGroups = assignRankings(workGroupStats);
            
            // Hide countdown, show podium
            document.getElementById('ceremonyCountdown').style.display = 'none';
            document.getElementById('ceremonyPodium').style.display = 'flex';
            
            // Create podium
            createPodium(rankedGroups);
            
            // Award XP and check for special titles
            awardXPAndTitles(rankedGroups);
            
            // Auto-close after 8 seconds
            setTimeout(() => {
                closeCeremony();
            }, 8000);
        }
        
function createPodium(rankedGroups) {
    const podium = document.getElementById('ceremonyPodium');
    podium.innerHTML = '';
    
    // Always create 3 positions
    const positions = [
        { rank: 2, class: 'podium-2nd', delay: 0.3 },
        { rank: 1, class: 'podium-1st', delay: 0.5 },
        { rank: 3, class: 'podium-3rd', delay: 0.1 }
    ];
    
    positions.forEach(pos => {
        const team = rankedGroups[pos.rank - 1];
        const podiumDiv = document.createElement('div');
        podiumDiv.className = `podium-position ${pos.class}`;
        podiumDiv.style.animationDelay = `${pos.delay}s`;
        
        if (team) {
            // Real team data
            podiumDiv.innerHTML = `
                <div class="podium-rank">#${pos.rank}</div>
                <div class="podium-icon">${team.tier.icon}</div>
                <div class="podium-team">${team.groupName}</div>
                <div class="podium-score">${team.stats.averageProgress}%</div>
            `;
        } else {
            // Placeholder for missing team
            podiumDiv.innerHTML = `
                <div class="podium-rank">#${pos.rank}</div>
                <div class="podium-icon">ü§∑‚Äç‚ôÇÔ∏è</div>
                <div class="podium-team">Awaiting Team</div>
                <div class="podium-score">--</div>
            `;
            podiumDiv.style.opacity = '0.5';
        }
        
        podium.appendChild(podiumDiv);
    });
}
        
        function createConfetti() {
            const colors = ['#fbbf24', '#ef4444', '#10b981', '#3b82f6', '#8b5cf6', '#f59e0b'];
            
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDelay = Math.random() * 3 + 's';
                    
                    document.getElementById('awardsCeremony').appendChild(confetti);
                    
                    setTimeout(() => {
                        if (confetti.parentNode) {
                            confetti.parentNode.removeChild(confetti);
                        }
                    }, 3000);
                }, i * 100);
            }
        }
        
        function closeCeremony() {
            document.getElementById('awardsCeremony').classList.remove('active');
            
            // Start the main dashboard update
            setTimeout(() => {
                updateDashboard();
                showMotivationalToast("üéä", "Awards ceremony complete! Dashboard updated!");
            }, 1000);
        }
        
        // ========================================
        // TEAM BATTLE MODE
        // ========================================
        
        function startTeamBattle() {
            const workGroupStats = calculateWorkGroupStats();
            const rankedGroups = assignRankings(workGroupStats);
            
            if (rankedGroups.length < 2) {
                showMotivationalToast("‚öîÔ∏è", "Need at least 2 teams for battle mode!");
                return;
            }
            
            const battleArena = document.getElementById('battleArena');
            battleArena.classList.add('active');
            
            createBattleDisplay(rankedGroups[0], rankedGroups[1]);
            playSound('battle');
        }
        
        function createBattleDisplay(team1, team2) {
            const contestants = document.getElementById('battleContestants');
            contestants.innerHTML = '';
            
            // Team 1
            const team1Div = document.createElement('div');
            team1Div.className = 'battle-team';
            if (team1.stats.averageProgress > team2.stats.averageProgress) {
                team1Div.classList.add('winner');
            }
            
            team1Div.innerHTML = `
                <div class="battle-team-icon">${team1.tier.icon}</div>
                <div class="battle-team-name">${team1.groupName}</div>
                <div class="battle-team-stats">${team1.stats.averageProgress}%</div>
                <div class="battle-xp">
                    <div class="battle-xp-label">Experience Level</div>
                    <div class="battle-xp-bar">
                        <div class="battle-xp-fill" style="width: ${getTeamLevel(team1.groupName) * 10}%">
                            <div class="battle-xp-text">LVL ${getTeamLevel(team1.groupName)}</div>
                        </div>
                    </div>
                </div>
                ${getSpecialTitle(team1.groupName) ? `<div class="special-title">${getSpecialTitle(team1.groupName)}</div>` : ''}
            `;
            
            // VS
            const vsDiv = document.createElement('div');
            vsDiv.className = 'battle-vs';
            vsDiv.textContent = 'VS';
            
            // Team 2
            const team2Div = document.createElement('div');
            team2Div.className = 'battle-team';
            if (team2.stats.averageProgress > team1.stats.averageProgress) {
                team2Div.classList.add('winner');
            }
            
            team2Div.innerHTML = `
                <div class="battle-team-icon">${team2.tier.icon}</div>
                <div class="battle-team-name">${team2.groupName}</div>
                <div class="battle-team-stats">${team2.stats.averageProgress}%</div>
                <div class="battle-xp">
                    <div class="battle-xp-label">Experience Level</div>
                    <div class="battle-xp-bar">
                        <div class="battle-xp-fill" style="width: ${getTeamLevel(team2.groupName) * 10}%">
                            <div class="battle-xp-text">LVL ${getTeamLevel(team2.groupName)}</div>
                        </div>
                    </div>
                </div>
                ${getSpecialTitle(team2.groupName) ? `<div class="special-title">${getSpecialTitle(team2.groupName)}</div>` : ''}
            `;
            
            contestants.appendChild(team1Div);
            contestants.appendChild(vsDiv);
            contestants.appendChild(team2Div);
        }
        
        function closeBattleMode() {
            document.getElementById('battleArena').classList.remove('active');
        }
        
        // ========================================
        // GAMIFICATION & XP SYSTEM
        // ========================================
        
        function awardXPAndTitles(rankedGroups) {
            rankedGroups.forEach((group, index) => {
                const teamName = group.groupName;
                const baseXP = calculateBaseXP(group.stats.averageProgress, index + 1);
                
                // Award XP
                awardXP(teamName, baseXP);
                
                // Check for special titles
                checkSpecialTitles(teamName, group);
                
                // Show XP notification for top performer
                if (index === 0) {
                    showXPNotification(baseXP, teamName);
                }
            });
        }
        
        function calculateBaseXP(averageProgress, rank) {
            let baseXP = averageProgress * 5; // Base XP from progress
            
            // Rank bonus
            switch(rank) {
                case 1: baseXP += 500; break;
                case 2: baseXP += 300; break;
                case 3: baseXP += 200; break;
                default: baseXP += 100;
            }
            
            return Math.round(baseXP);
        }
        
        function awardXP(teamName, xpAmount) {
            if (!teamXP[teamName]) teamXP[teamName] = 0;
            teamXP[teamName] += xpAmount;
            
            // Check for level up
            const newLevel = Math.floor(teamXP[teamName] / 1000) + 1;
            const currentLevel = teamLevels[teamName] || 1;
            
            if (newLevel > currentLevel) {
                teamLevels[teamName] = newLevel;
                showLevelUpNotification(teamName, newLevel);
            }
        }
        
        function getTeamLevel(teamName) {
            return teamLevels[teamName] || 1;
        }
        
        function getTeamXP(teamName) {
            return teamXP[teamName] || 0;
        }
        
        function getSpecialTitle(teamName) {
            return specialTitles[teamName] || null;
        }
        
        function checkSpecialTitles(teamName, group) {
            // Platform Warrior - 95%+ average
            if (group.stats.averageProgress >= 95 && !specialTitles[teamName]) {
                awardSpecialTitle(teamName, 'platform_warrior');
            }
            
            // Perfectionist - 100% completion
            if (group.stats.averageProgress === 100 && !specialTitles[teamName]) {
                awardSpecialTitle(teamName, 'perfectionist');
            }
            
            // Comeback Legend - from last to first
            if (group.rank === 1 && group.previousRank >= 5) {
                awardSpecialTitle(teamName, 'comeback_legend');
            }
        }
        
        function awardSpecialTitle(teamName, titleId) {
            const title = specialTitlesList.find(t => t.id === titleId);
            if (title) {
                specialTitles[teamName] = title.name;
                awardXP(teamName, title.xpBonus);
                showTitleUnlockedNotification(teamName, title);
            }
        }
        
        function showXPNotification(xpAmount, teamName) {
            const notification = document.getElementById('xpNotification');
            notification.querySelector('.xp-amount').textContent = `+${xpAmount} XP`;
            notification.querySelector('div:last-child').textContent = `${teamName} LEVEL UP!`;
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        function showLevelUpNotification(teamName, newLevel) {
            showMotivationalToast("‚¨ÜÔ∏è", `${teamName} reached Level ${newLevel}! Experience mastery!`);
            playSound('levelup');
        }
        
        function showTitleUnlockedNotification(teamName, title) {
            showMotivationalToast("üéñÔ∏è", `${teamName} unlocked: ${title.name}!`);
            playSound('achievement');
        }
    </script>
</body>
</html>